# <a name="how-the-office-javascript-api-documentation-is-generated"></a><span data-ttu-id="6b9e7-101">Сведения о том, как создается документация по API JavaScript для Office</span><span class="sxs-lookup"><span data-stu-id="6b9e7-101">How the Office JavaScript API documentation is generated</span></span>

<span data-ttu-id="6b9e7-102">Страницы справочной документации по JavaScript для Office создаются на основе файлов определений типов и примеров фрагментов.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-102">The Office JavaScript reference documentation pages are generated from type definition files and example snippets.</span></span> <span data-ttu-id="6b9e7-103">В этом процессе используется смешение средств с открытым кодом и сценариев, характерных для репозитория.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-103">This process uses a blend of open source tools and repository-specific scripts.</span></span> <span data-ttu-id="6b9e7-104">Этот документ предназначен для того, чтобы сделать процессы этого репозитория прозрачными, чтобы сообщество могло лучше пользоваться этим содержимым и вносить в него изменения.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-104">This document aims to make the processes of this repository transparent so the community can better benefit from and contribute to this content.</span></span>

## <a name="content-sources"></a><span data-ttu-id="6b9e7-105">Источники контента</span><span class="sxs-lookup"><span data-stu-id="6b9e7-105">Content sources</span></span>

<span data-ttu-id="6b9e7-106">Для создания справочной документации по Office – JS используются два типа контента: определения типов и фрагменты кода.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-106">Two types of content are combined to create the Office-JS reference documentation: type definitions and code snippets.</span></span> <span data-ttu-id="6b9e7-107">Они обеспечивают полное покрытие API и предоставляют небольшие примеры встроенного кода.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-107">These ensure complete API coverage and give small, inline code samples.</span></span>

### <a name="type-definition-files"></a><span data-ttu-id="6b9e7-108">Файлы определений типов</span><span class="sxs-lookup"><span data-stu-id="6b9e7-108">Type definition files</span></span>

<span data-ttu-id="6b9e7-109">Файлы определения типов по [определенному](https://github.com/DefinitelyTyped/DefinitelyTyped) типу представляют собой единственный источник истинности документации.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-109">The type definition files on [Definitely Typed](https://github.com/DefinitelyTyped/DefinitelyTyped) are the single source of truth for the documentation.</span></span> <span data-ttu-id="6b9e7-110">Все надстройки Office, использующие TypeScript, компилируются с использованием этих файлов определений типов.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-110">Any Office Add-in that uses TypeScript compiles by using these type definition files.</span></span> <span data-ttu-id="6b9e7-111">Они также предоставляют разработчикам функций IntelliSense и TypeScript поддержку IntelliSense.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-111">These also give JavaScript and TypeScript developers IntelliSense capabilities.</span></span> <span data-ttu-id="6b9e7-112">Создав справочную документацию из этих определений, мы предоставляем более точную информацию.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-112">By building the reference documentation from these definitions, we provide more accurate information.</span></span>

<span data-ttu-id="6b9e7-113">Существует четыре релевантных файла d. TS, которые предоставляют исходное содержимое для разных подразделов документов.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-113">There are four relevant d.ts files that provide source content for different subsections of the docs.</span></span>

- <span data-ttu-id="6b9e7-114">[Office-JS/index. d. TS](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts) (определения выпуска).</span><span class="sxs-lookup"><span data-stu-id="6b9e7-114">[office-js/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts) (The Release definitions.)</span></span>
  - [<span data-ttu-id="6b9e7-115">Excel (выпуск)</span><span class="sxs-lookup"><span data-stu-id="6b9e7-115">Excel (Release)</span></span>](https://docs.microsoft.com/javascript/api/excel_release)
  - [<span data-ttu-id="6b9e7-116">OneNote</span><span class="sxs-lookup"><span data-stu-id="6b9e7-116">OneNote</span></span>](https://docs.microsoft.com/javascript/api/onenote)
  - [<span data-ttu-id="6b9e7-117">PowerPoint</span><span class="sxs-lookup"><span data-stu-id="6b9e7-117">PowerPoint</span></span>](https://docs.microsoft.com/javascript/api/powerpoint)
  - [<span data-ttu-id="6b9e7-118">Visio</span><span class="sxs-lookup"><span data-stu-id="6b9e7-118">Visio</span></span>](https://docs.microsoft.com/javascript/api/visio)
  - [<span data-ttu-id="6b9e7-119">Word (выпуск)</span><span class="sxs-lookup"><span data-stu-id="6b9e7-119">Word (Release)</span></span>](https://docs.microsoft.com/javascript/api/word_release)
  - [<span data-ttu-id="6b9e7-120">Подраздел Оффицеекстенсионс общего API</span><span class="sxs-lookup"><span data-stu-id="6b9e7-120">OfficeExtensions subsection of the Common API</span></span>](https://docs.microsoft.com/javascript/api/office)
- <span data-ttu-id="6b9e7-121">[Office-JS-Preview/index. d. TS](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts) (определения предварительного просмотра).</span><span class="sxs-lookup"><span data-stu-id="6b9e7-121">[office-js-preview/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts) (The Preview definitions.)</span></span>
  - [<span data-ttu-id="6b9e7-122">Excel (Предварительная версия)</span><span class="sxs-lookup"><span data-stu-id="6b9e7-122">Excel (Preview)</span></span>](https://docs.microsoft.com/javascript/api/excel)
  - [<span data-ttu-id="6b9e7-123">Outlook (Предварительная версия)</span><span class="sxs-lookup"><span data-stu-id="6b9e7-123">Outlook (Preview)</span></span>](https://docs.microsoft.com/javascript/api/outlook)
  - [<span data-ttu-id="6b9e7-124">Word (Предварительная версия)</span><span class="sxs-lookup"><span data-stu-id="6b9e7-124">Word (Preview)</span></span>](https://docs.microsoft.com/javascript/api/word)
  - [<span data-ttu-id="6b9e7-125">Общий API</span><span class="sxs-lookup"><span data-stu-id="6b9e7-125">Common API</span></span>](https://docs.microsoft.com/javascript/api/office)
- <span data-ttu-id="6b9e7-126">[Custom-Function-Runtime/index. d. TS](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/custom-functions-runtime/index.d.ts) (определения среды выполнения пользовательских функций Excel).</span><span class="sxs-lookup"><span data-stu-id="6b9e7-126">[custom-functions-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/custom-functions-runtime/index.d.ts) (The Excel Custom Functions runtime definitions.)</span></span>
  - [<span data-ttu-id="6b9e7-127">Пользовательские функции</span><span class="sxs-lookup"><span data-stu-id="6b9e7-127">Custom Functions</span></span>](https://docs.microsoft.com/javascript/api/custom-functions-runtime)
- <span data-ttu-id="6b9e7-128">[Office-Runtime/index. d. TS](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/office-runtime/index.d.ts) (определения среды выполнения Office для платформы пользовательских функций).</span><span class="sxs-lookup"><span data-stu-id="6b9e7-128">[office-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/office-runtime/index.d.ts) (The office runtime definitions for the Custom Functions platform.)</span></span>
  - [<span data-ttu-id="6b9e7-129">Среда выполнения Office</span><span class="sxs-lookup"><span data-stu-id="6b9e7-129">Office Runtime</span></span>](https://docs.microsoft.com/javascript/api/office-runtime)

<span data-ttu-id="6b9e7-130">Более ранние версии API имеют собственные файлы d. TS.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-130">Older versions of the APIs have their own d.ts files.</span></span> <span data-ttu-id="6b9e7-131">Они сохраняются при отпускании новой версии набора обязательных элементов API.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-131">These are preserved when a new API requirement set is released.</span></span> <span data-ttu-id="6b9e7-132">Они также могут быть созданы с помощью [средства версии ремовер](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/tools/VersionRemover.ts).</span><span class="sxs-lookup"><span data-stu-id="6b9e7-132">They can also be generated using the [Version Remover tool](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/tools/VersionRemover.ts).</span></span> <span data-ttu-id="6b9e7-133">Эти старые файлы d. TS поддерживаются таким образом, что в API событий исправлены или изменены, исходное поведение по-прежнему задокументировано.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-133">These old d.ts files are maintained so that in the event APIs are patched or altered, the original behavior is still documented.</span></span> <span data-ttu-id="6b9e7-134">Это полезно, если необходимо ориентироваться на более старую версию API.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-134">This is useful if you have to target an older version of the API.</span></span>

#### <a name="testing-type-definition-file-changes"></a><span data-ttu-id="6b9e7-135">Тестирование изменений в файле определений типов</span><span class="sxs-lookup"><span data-stu-id="6b9e7-135">Testing type definition file changes</span></span>

<span data-ttu-id="6b9e7-136">Все изменения документации для API JavaScript для Office выполняются путем изменения четырех файлов d. TS, упомянутых выше.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-136">Any documentation changes for the Office JavaScript API are done by editing the four d.ts files mentioned above.</span></span> <span data-ttu-id="6b9e7-137">Тем не менее, вы можете протестировать изменения перед отправкой DefinitelyTyped (если необходимо, например, протестировать преобразование форматирования в Markdown), изменив соответствующий файл в разделе [Generate-Files/Script-Inputs](https://github.com/OfficeDev/office-js-docs-reference/tree/master/generate-docs/script-inputs) и запуска [женератедокс. cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd).</span><span class="sxs-lookup"><span data-stu-id="6b9e7-137">However, you can test a change before submitting a PR to DefinitelyTyped (if you need to, for example, test how your formatting will translate into markdown) by editing the corresponding file in [generate-docs/script-inputs](https://github.com/OfficeDev/office-js-docs-reference/tree/master/generate-docs/script-inputs) and running [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd).</span></span> <span data-ttu-id="6b9e7-138">При появлении соответствующего запроса выберите параметр "Локальные файлы".</span><span class="sxs-lookup"><span data-stu-id="6b9e7-138">When prompted, select the "Local files" option.</span></span>

<span data-ttu-id="6b9e7-139">Если вы помещаете изменения в удаленную ветвь этого репозитория, платформа docs.microsoft.com создает тестовую ветвь.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-139">Pushing changes to a remote branch of this repo causes the docs.microsoft.com platform to build a test branch.</span></span> <span data-ttu-id="6b9e7-140">Эта ветвь отображается в review.docs.microsoft.com, который доступен только внутренним сотрудникам Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-140">This branch is rendered on review.docs.microsoft.com, which is only accessible by internal Microsoft personnel.</span></span> <span data-ttu-id="6b9e7-141">Любой пользователь, просматривающий пр, проверит сайт проверки на точность.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-141">Anyone reviewing your PR will check the review site for accuracy.</span></span>

### <a name="code-snippets"></a><span data-ttu-id="6b9e7-142">Фрагменты кода</span><span class="sxs-lookup"><span data-stu-id="6b9e7-142">Code snippets</span></span>

<span data-ttu-id="6b9e7-143">Фрагменты кода примеров кода добавляются на эталонные страницы из двух источников:</span><span class="sxs-lookup"><span data-stu-id="6b9e7-143">Code example snippets are added to the reference pages from two sources:</span></span>

- [<span data-ttu-id="6b9e7-144">Примеры сценариев лаборатории</span><span class="sxs-lookup"><span data-stu-id="6b9e7-144">Script Lab Samples</span></span>](https://github.com/OfficeDev/office-js-snippets)
- [<span data-ttu-id="6b9e7-145">Локальные фрагменты кода</span><span class="sxs-lookup"><span data-stu-id="6b9e7-145">Local Code Snippets</span></span>](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/code-snippets)

<span data-ttu-id="6b9e7-146">Локальные фрагменты находятся в файлах ямл для конкретных узлов.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-146">The local snippets are in host-specific yaml files.</span></span> <span data-ttu-id="6b9e7-147">Их содержимое упорядочено по классу и полю, поэтому его можно сопоставить с соответствующим местом на странице справки.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-147">Their content is organized by class and field, so it can be mapped to the appropriate place in a reference page.</span></span> <span data-ttu-id="6b9e7-148">Язык фрагмента кода (JavaScript или TypeScript) определяется с помощью операторов await.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-148">The language of the snippet (JavaScript or TypeScript) is inferred by the use of await statements.</span></span>

<span data-ttu-id="6b9e7-149">Фрагменты лабораторий сценариев извлекаются из рабочих примеров.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-149">The Script Lab snippets are pulled from working samples.</span></span> <span data-ttu-id="6b9e7-150">В настоящее время примеры, Excel, Outlook и Word сопоставляются с разделами документа с помощью [файлов сопоставления](https://github.com/OfficeDev/office-js-snippets/tree/master/snippet-extractor-metadata).</span><span class="sxs-lookup"><span data-stu-id="6b9e7-150">Currently, Excel, Outlook, and Word samples are mapped to reference document sections through [mapping files](https://github.com/OfficeDev/office-js-snippets/tree/master/snippet-extractor-metadata).</span></span> <span data-ttu-id="6b9e7-151">Они совпадают с отдельными примерами методов к свойствам или методам в API.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-151">These match individual sample methods to properties or methods in the API.</span></span> <span data-ttu-id="6b9e7-152">При `yarn start` запуске репозитория Office-JS-Snippets создается [файл ямл](https://github.com/OfficeDev/office-js-snippets/blob/master/snippet-extractor-output/snippets.yaml) , содержащий все сопоставленные фрагменты.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-152">When the office-js-snippets repository's `yarn start` runs, [a yaml file](https://github.com/OfficeDev/office-js-snippets/blob/master/snippet-extractor-output/snippets.yaml) containing all the mapped snippets is created.</span></span> <span data-ttu-id="6b9e7-153">Этот файл ямл является входными данными в справочной документации.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-153">This yaml file is the input into the reference documentation tooling.</span></span>

## <a name="tooling-pipeline"></a><span data-ttu-id="6b9e7-154">Программный конвейер</span><span class="sxs-lookup"><span data-stu-id="6b9e7-154">Tooling pipeline</span></span>

![Изображение, которое показывает потоки управления от неопределенного типа, до препроцессора, средства извлечения API, мидпроцессор, документации API и до препроцессора.](ToolingPipeline.png)

<span data-ttu-id="6b9e7-156">Содержимое документации между источниками контента и последними страницами проходит через пять этапов:</span><span class="sxs-lookup"><span data-stu-id="6b9e7-156">Between the content sources and the final pages, the documentation content goes through five tooling steps:</span></span>

1. [<span data-ttu-id="6b9e7-157">Скрипт препроцессора</span><span class="sxs-lookup"><span data-stu-id="6b9e7-157">Preprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/preprocessor.ts)
1. [<span data-ttu-id="6b9e7-158">Средство извлечения API</span><span class="sxs-lookup"><span data-stu-id="6b9e7-158">API Extractor</span></span>](https://api-extractor.com/)
1. [<span data-ttu-id="6b9e7-159">Сценарий мидпроцессор</span><span class="sxs-lookup"><span data-stu-id="6b9e7-159">Midprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/midprocessor.ts)
1. [<span data-ttu-id="6b9e7-160">Документ API</span><span class="sxs-lookup"><span data-stu-id="6b9e7-160">API Documenter</span></span>](https://github.com/microsoft/rushstack/blob/master/apps/api-documenter/README.md)
1. [<span data-ttu-id="6b9e7-161">Скрипт для препроцессора</span><span class="sxs-lookup"><span data-stu-id="6b9e7-161">Postprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/postprocessor.ts)

<span data-ttu-id="6b9e7-162">Препроцессор выполняет файлы d. TS и разделяет их на разделы, зависящие от узла.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-162">The preprocessor takes the d.ts files and splits them into host-specific sections.</span></span> <span data-ttu-id="6b9e7-163">Он выполняет все необходимые средства очистки для правильной обработки данных в последующих средствах.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-163">It performs any cleanup necessary for the subsequent tools to properly process the data.</span></span>

<span data-ttu-id="6b9e7-164">Средство извлечения API преобразует файлы d. TS в данные JSON.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-164">API Extractor converts the d.ts files into JSON data.</span></span> <span data-ttu-id="6b9e7-165">В этом разделе заменяются все данные типа, что позволяет упростить анализ.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-165">This tokenizes all the type data, allowing for easier parsing.</span></span>

<span data-ttu-id="6b9e7-166">Мидпроцессор извлекает фрагменты кода и пары их с соответствующими узлами и очищает кросслинкинг между Outlook и общими объектами API.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-166">The midprocessor retrieves the code snippets and pairs them with the proper hosts, and cleans up the crosslinking between Outlook and Common API objects.</span></span>

<span data-ttu-id="6b9e7-167">Document API преобразует данные JSON в файлы. yml.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-167">API Documenter converts the JSON data into .yml files.</span></span> <span data-ttu-id="6b9e7-168">Файлы. yml преобразуются в Markdown с помощью открытой системы публикации, которая публикует документы в docs.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-168">The .yml files are converted to markdown by the Open Publishing System that publishes our docs to docs.microsoft.com.</span></span> <span data-ttu-id="6b9e7-169">Document API также содержит расширение для Office, которое вставляет фрагменты кода.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-169">API Documenter also contains an Office-specific extension that inserts our code snippets.</span></span>

<span data-ttu-id="6b9e7-170">На этом процессоре выполняется очистка оглавления и перемещение файлов. yml в [папку публикации](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/docs-ref-autogen).</span><span class="sxs-lookup"><span data-stu-id="6b9e7-170">The postprocessor cleans up the table of contents and moves the .yml files into the [publishing folder](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/docs-ref-autogen).</span></span>

<span data-ttu-id="6b9e7-171">Все пять из этих действий выполняются при запуске [женератедокс. cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd) .</span><span class="sxs-lookup"><span data-stu-id="6b9e7-171">All five of these steps are performed when [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd) is run.</span></span> <span data-ttu-id="6b9e7-172">Этот скрипт также обрабатывает установку модуля узла, очищает старые наборы файлов и файлы определений типов версий для каждого набора требований.</span><span class="sxs-lookup"><span data-stu-id="6b9e7-172">That script also handles node module installation, cleans out old file sets, and versions Type Definition files for each requirement set.</span></span>
