### YamlMime:UniversalReference
ms.openlocfilehash: e8ec4f103dcf082185bd9fa09cb194ad2977ea90
ms.sourcegitcommit: 6c48441b8be51d3a9d7dc836e386230a155feceb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/22/2019
ms.locfileid: "30199699"
items:
- uid: Outlook_1_7.Office.Mailbox
  summary: >-
    Предоставляет для Microsoft Outlook и Microsoft Outlook в Интернете доступ к объектной модели надстройки Outlook.


    Пространства имен


    - diagnostics. Предоставляет надстройке Outlook диагностические сведения.


    - item. Предоставляет методы и свойства для доступа к сообщению или встрече в надстройке Outlook.


    - userProfile. Предоставляет сведения о пользователе в надстройке Outlook.


    \[[Набор API: Mailbox 1,0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>С ограничениями</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>
  name: Office.Mailbox
  fullName: Office.Mailbox
  langs:
  - typeScript
  type: interface
  package: Outlook_1_7
  children:
  - Outlook_1_7.Office.Mailbox.addHandlerAsync
  - Outlook_1_7.Office.Mailbox.addHandlerAsync_1
  - Outlook_1_7.Office.Mailbox.convertToEwsId
  - Outlook_1_7.Office.Mailbox.convertToLocalClientTime
  - Outlook_1_7.Office.Mailbox.convertToRestId
  - Outlook_1_7.Office.Mailbox.convertToUtcClientTime
  - Outlook_1_7.Office.Mailbox.displayAppointmentForm
  - Outlook_1_7.Office.Mailbox.displayMessageForm
  - Outlook_1_7.Office.Mailbox.displayNewAppointmentForm
  - Outlook_1_7.Office.Mailbox.displayNewMessageForm
  - Outlook_1_7.Office.Mailbox.getCallbackTokenAsync
  - Outlook_1_7.Office.Mailbox.getCallbackTokenAsync_1
  - Outlook_1_7.Office.Mailbox.getUserIdentityTokenAsync
  - Outlook_1_7.Office.Mailbox.makeEwsRequestAsync
  - Outlook_1_7.Office.Mailbox.removeHandlerAsync
  - Outlook_1_7.Office.Mailbox.removeHandlerAsync_1
  - Outlook_1_7.Office.Mailbox.diagnostics
  - Outlook_1_7.Office.Mailbox.ewsUrl
  - Outlook_1_7.Office.Mailbox.item
  - Outlook_1_7.Office.Mailbox.restUrl
  - Outlook_1_7.Office.Mailbox.userProfile
- uid: Outlook_1_7.Office.Mailbox.addHandlerAsync
  summary: >-
    Добавляет обработчик для поддерживаемого события.


    В настоящее время единственным поддерживаемым типом события `Office.EventType.ItemChanged` <!-- -->является.


    \[[Набор API: Mailbox 1,5](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>ReadItem</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>
  name: addHandlerAsync(eventType, handler, options, callback)
  fullName: addHandlerAsync(eventType, handler, options, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'addHandlerAsync(eventType: Office.EventType, handler: (type: Office.EventType) => void, options?: Office.AsyncContextOptions, callback?: (asyncResult: Office.AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: eventType
      description: Событие, которое должно вызвать обработчик.
      type:
      - Office.EventType
    - id: handler
      description: Функция для обработки события. Функция должна принимать один параметр, который является литералом объекта. Свойство Type для параметра будет сопоставляться с параметром eventType, переданному в addHandlerAsync.
      type:
      - '(type: Office.EventType) => void'
    - id: options
      description: Необязательное свойство. Предоставляет параметр для сохранения данных контекста любого типа без изменений для использования при обратном вызове.
      type:
      - Office.AsyncContextOptions
    - id: callback
      description: Необязательное свойство. После выполнения метода функция, переданная в параметре callback, вызывается с помощью одного параметра типа Office. AsyncResult.
      type:
      - '(asyncResult: Office.AsyncResult<void>) => void'
- uid: Outlook_1_7.Office.Mailbox.addHandlerAsync_1
  summary: >-
    Добавляет обработчик для поддерживаемого события.


    В настоящее время единственным поддерживаемым типом события `Office.EventType.ItemChanged` <!-- -->является.


    \[[Набор API: Mailbox 1,5](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: >-
    <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>ReadItem</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>

    ####Примеры


    ```javascript

    Office.initialize = function (reason) {
        $(document).ready(function () {
            Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged, loadNewItem, function (result) {
            if (result.status === Office.AsyncResultStatus.Failed) {
                    // Handle error.
                }
            });
        });
    };


    function loadNewItem(eventArgs) {
        // Load the properties of the newly selected item.
        loadProps(Office.context.mailbox.item);
    }

    ```
  name: addHandlerAsync(eventType, handler, callback)
  fullName: addHandlerAsync(eventType, handler, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'addHandlerAsync(eventType: Office.EventType, handler: (type: Office.EventType) => void, callback?: (asyncResult: Office.AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: eventType
      description: Событие, которое должно вызвать обработчик.
      type:
      - Office.EventType
    - id: handler
      description: Функция для обработки события. Функция должна принимать один параметр, который является литералом объекта. Свойство Type для параметра будет сопоставляться с параметром eventType, переданному в addHandlerAsync.
      type:
      - '(type: Office.EventType) => void'
    - id: callback
      description: Необязательное свойство. После выполнения метода функция, переданная в параметре callback, вызывается с помощью одного параметра типа Office. AsyncResult.
      type:
      - '(asyncResult: Office.AsyncResult<void>) => void'
- uid: Outlook_1_7.Office.Mailbox.convertToEwsId
  summary: >-
    Преобразовывает идентификатор элемента из формата REST в формат EWS.


    Формат идентификаторов, извлекаемых через API REST (такие как API Почты Outlook или Microsoft Graph), отличается от формата веб-служб Exchange (EWS). Метод Конверттоевсид преобразует идентификатор в формате REST в правильном формате для EWS.


    **Примечание**: Этот метод не поддерживается в Outlook для iOS или Outlook для Android.


    \[[Набор API: Mailbox 1,3](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: >-
    <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>С ограничениями</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>

    ####Примеры


    ```javascript

    // Get an item's ID from a REST API.

    var restId = 'AAMkAGVlOTZjNTM3LW...';


    // Treat restId as coming from the v2.0 version of the Outlook Mail API.

    var ewsId = Office.context.mailbox.convertToEwsId(restId, Office.MailboxEnums.RestVersion.v2_0);

    ```
  name: convertToEwsId(itemId, restVersion)
  fullName: convertToEwsId(itemId, restVersion)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'convertToEwsId(itemId: string, restVersion: MailboxEnums.RestVersion): string;'
    return:
      type:
      - string
      description: ''
    parameters:
    - id: itemId
      description: Идентификатор элемента, отформатированный для REST API Outlook.
      type:
      - string
    - id: restVersion
      description: Значение, определяющее версию REST API для Outlook, которая используется для извлечения идентификатора элемента.
      type:
      - MailboxEnums.RestVersion
- uid: Outlook_1_7.Office.Mailbox.convertToLocalClientTime
  summary: >-
    Получает словарь, содержащий сведения о локальном времени клиента.


    В случае дат и времени в почтовом приложении для Outlook или Outlook Web App могут использоваться разные часовые пояса. Outlook использует часовой пояс клиентского компьютера. Outlook Web App использует часовой пояс, заданный в Центре администрирования Exchange (EAC). Значения даты и времени должны обрабатываться так, чтобы значения в пользовательском интерфейсе всегда согласовывались с часовым поясом, ожидаемым пользователем.


    Если почтовое приложение выполняется в Outlook, метод convertToLocalClientTime возвратит объект словаря со значениями, заданными для часового пояса клиентского компьютера. Если почтовое приложение выполняется в Outlook Web App, метод convertToLocalClientTime возвратит объект словаря со значениям, заданными для часового пояса в Центре администрирования Exchange.


    \[[Набор API: Mailbox 1,0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>ReadItem</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>
  name: convertToLocalClientTime(timeValue)
  fullName: convertToLocalClientTime(timeValue)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'convertToLocalClientTime(timeValue: Date): LocalClientTime;'
    return:
      type:
      - LocalClientTime
      description: ''
    parameters:
    - id: timeValue
      description: Объект Date.
      type:
      - Date
- uid: Outlook_1_7.Office.Mailbox.convertToRestId
  summary: >-
    Преобразовывает идентификатор элемента в формате EWS в формат REST.


    **Примечание**: Этот метод не поддерживается в Outlook для iOS или Outlook для Android.


    \[[Набор API: Mailbox 1,3](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: >-
    <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>С ограничениями</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>


    Идентификаторы элементов, получаемые с помощью EWS или с помощью свойства itemId, используют формат, отличный от формата, используемого REST API (например, [API почты Outlook](https://docs.microsoft.com/previous-versions/office/office-365-api/api/version-2.0/mail-rest-operations) или [Microsoft Graph](https://graph.microsoft.io/)<!-- -->). Метод convertToRestId преобразует идентификатор в формате EWS в нужный формат для REST.

    #### <a name="examples"></a>Примеры


    ```javascript

    // Get the currently selected item's ID.

    var ewsId = Office.context.mailbox.item.itemId;


    // Convert to a REST ID for the v2.0 version of the Outlook Mail API.

    var restId = Office.context.mailbox.convertToRestId(ewsId, Office.MailboxEnums.RestVersion.v2_0);

    ```
  name: convertToRestId(itemId, restVersion)
  fullName: convertToRestId(itemId, restVersion)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'convertToRestId(itemId: string, restVersion: MailboxEnums.RestVersion): string;'
    return:
      type:
      - string
      description: ''
    parameters:
    - id: itemId
      description: Идентификатор элемента в формате EWS
      type:
      - string
    - id: restVersion
      description: Значение, определяющее версию REST API для Outlook, с которой будет использоваться преобразованный идентификатор.
      type:
      - MailboxEnums.RestVersion
- uid: Outlook_1_7.Office.Mailbox.convertToUtcClientTime
  summary: >-
    Получает объект Date из словаря, содержащего сведения о времени.


    Метод convertToUtcClientTime преобразует словарь, содержащий локальную дату и время, в объект Date с правильными значениями локальной даты и времени.


    \[[Набор API: Mailbox 1,0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>ReadItem</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>
  name: convertToUtcClientTime(input)
  fullName: convertToUtcClientTime(input)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'convertToUtcClientTime(input: LocalClientTime): Date;'
    return:
      type:
      - Date
      description: Объект Date со временем в формате UTC.
    parameters:
    - id: input
      description: Значение локального времени для преобразования.
      type:
      - LocalClientTime
- uid: Outlook_1_7.Office.Mailbox.displayAppointmentForm
  summary: >-
    Отображает имеющуюся встречу из календаря.


    Метод displayAppointmentForm открывает существующую встречу в календаре в новом окне на рабочем столе или в диалоговом окне на мобильных устройствах.


    В Outlook для Mac с помощью этого метода можно отобразить одну встречу, которая не является частью повторяющегося ряда, или основную встречу такого ряда, но не экземпляр из него, так как в Outlook для Mac невозможно получить доступ к свойствам экземпляра повторяющегося ряда (в том числе к идентификатору элемента).


    В Outlook Web App этот метод открывает указанную форму, только если текст формы содержит символы размером не более 32 КБ.


    Если указанный идентификатор элемента не определяет существующую встречу, на клиентском компьютере или устройстве открывается пустая страница, и сообщение об ошибке не возвращается.


    **Примечание**: Этот метод не поддерживается в Outlook для iOS или Outlook для Android.


    \[[Набор API: Mailbox 1,0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: >-
    <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>ReadItem</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>

    ####Примеры


    ```javascript

    Office.context.mailbox.displayAppointmentForm(appointmentId);

    ```
  name: displayAppointmentForm(itemId)
  fullName: displayAppointmentForm(itemId)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'displayAppointmentForm(itemId: string): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: itemId
      description: Идентификатор веб-служб Exchange для существующей встречи в календаре.
      type:
      - string
- uid: Outlook_1_7.Office.Mailbox.displayMessageForm
  summary: >-
    Отображает имеющееся сообщение.


    Метод displayMessageForm открывает существующее сообщение в новом окне на рабочем столе или в диалоговом окне на мобильных устройствах.


    В Outlook Web App этот метод открывает указанную форму, только если текст формы содержит символы размером не более 32 КБ.


    Если указанный идентификатор элемента не определяет существующее сообщение, окно на клиентском компьютере не открывается и сообщение об ошибке не возвращается.


    Не используйте метод displayMessageForm с параметром itemId, который представляет собой встречу. Используйте метод displayAppointmentForm, чтобы отобразить существующую встречу, а метод displayNewAppointmentForm — для отображения формы создания встречи.


    **Примечание**: Этот метод не поддерживается в Outlook для iOS или Outlook для Android.


    \[[Набор API: Mailbox 1,0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: >-
    <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>ReadItem</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>

    ####Примеры


    ```javascript

    Office.context.mailbox.displayMessageForm(messageId);

    ```
  name: displayMessageForm(itemId)
  fullName: displayMessageForm(itemId)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'displayMessageForm(itemId: string): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: itemId
      description: Идентификатор веб-служб Exchange для существующего сообщения.
      type:
      - string
- uid: Outlook_1_7.Office.Mailbox.displayNewAppointmentForm
  summary: >-
    Отображает форму для создания новой встречи в календаре.


    Метод displayNewAppointmentForm открывает форму, которая позволяет пользователю создать встречу или собрание. Если параметры заданы, поля формы встречи автоматически заполняются значениями этих параметров.


    В Outlook Web App и Outlook Web App для устройств этот метод всегда отображает форму с полем участников. Если вы не укажете участников в качестве входных аргументов, метод отображает форму с кнопкой Сохранить. Если вы укажете участников, форма будет включать участников и кнопку Отправить.


    В расширенном клиенте Outlook и Outlook RT при указании участников или ресурсов в параметре requiredAttendees, optionalAttendees или Resources в этом методе отображается форма собрания с кнопкой Отправить. Если не указать получателей, этот метод отображает форму встречи с кнопкой Сохранить &amp; закрыть.


    Если параметры превышают указанные ограничения размера или если указано неизвестное имя параметра, вызывается исключение.


    **Примечание**: Этот метод не поддерживается в Outlook для iOS или Outlook для Android.


    \[[Набор API: Mailbox 1,0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: >-
    <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>ReadItem</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Чтение</td></tr> </table>

    ####Примеры


    ```javascript

    var start = new Date();

    var end = new Date();

    end.setHours(start.getHours() + 1);


    Office.context.mailbox.displayNewAppointmentForm(

    {
        requiredAttendees: ['bob@contoso.com'],
        optionalAttendees: ['sam@contoso.com'],
        start: start,
        end: end,
        location: 'Home',
        resources: ['projector@contoso.com'],
        subject: 'meeting',
        body: 'Hello World!'
    });

    ```
  name: displayNewAppointmentForm(parameters)
  fullName: displayNewAppointmentForm(parameters)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'displayNewAppointmentForm(parameters: AppointmentForm): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: parameters
      description: Аппоинтментформ, описывающий новую встречу. Все свойства являются необязательными.
      type:
      - AppointmentForm
- uid: Outlook_1_7.Office.Mailbox.displayNewMessageForm
  summary: >-
    Отображает форму для создания сообщения.


    Метод Дисплайневмессажеформ открывает форму, которая позволяет пользователю создать новое сообщение. Если параметры заданы, поля формы сообщения автоматически заполняются их содержимым.


    Если параметры превышают указанные ограничения размера или если указано неизвестное имя параметра, вызывается исключение.


    \[[Набор API: Mailbox 1,6](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: >-
    <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>ReadItem</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Чтение</td></tr> </table>

    ####Примеры


    ```javascript

    Office.context.mailbox.displayNewMessageForm(

    {
        // Copy the To line from current item.
        toRecipients: Office.context.mailbox.item.to,
        ccRecipients: ['sam@contoso.com'],
        subject: 'Outlook add-ins are cool!',
        htmlBody: 'Hello <b>World</b>!<br/><img src="cid:image.png"></i>',
        attachments: [
        {
            type: 'file',
            name: 'image.png',
            url: 'http://contoso.com/image.png',
            isInline: true
        }
        ]
    });

    ```
  name: displayNewMessageForm(parameters)
  fullName: displayNewMessageForm(parameters)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'displayNewMessageForm(parameters: any): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: parameters
      description: >-
        Словарь, содержащий все значения, которые необходимо заполнить для пользователя в новой форме. Все параметры являются необязательными.


        toRecipients: массив строк, содержащий адреса электронной почты или массив, содержащий объект [Office. EmailAddressDetails](xref:Outlook_1_7.Office.EmailAddressDetails) для каждого из получателей в строке "Кому". Массив может включать не более 100 записей.


        ccRecipients: массив строк, содержащий адреса электронной почты или массив, содержащий объект [Office. EmailAddressDetails](xref:Outlook_1_7.Office.EmailAddressDetails) для каждого получателя в строке "копия". Массив может включать не более 100 записей.


        bccRecipients: массив строк, содержащий адреса электронной почты или массив, содержащий объект [Office. EmailAddressDetails](xref:Outlook_1_7.Office.EmailAddressDetails) для каждого из получателей в строке "СК". Массив может включать не более 100 записей.


        Тема: строка, содержащая тему сообщения. Максимальное количество символов в строке — 255.


        htmlBody: текст сообщения в формате HTML. Максимальный размер содержимого сообщения — 32 КБ.


        вложения: массив объектов JSON, которые являются вложениями файлов или элементов.


        вложения. Тип: указывает тип вложения. Должен быть File для вложенного файла или элемента для вложения элемента.


        attachments.name: строка, содержащая имя вложения, длиной до 255 символов.


        вложения. URL: используется только в том случае, если для Type задано значение File. Универсальный код ресурса (URI) расположения файла.


        вложения. isInline: используется только в том случае, если для Type задано значение File. Если этот параметр имеет значение true, то вложение будет отображаться встроенным в текст сообщения и не должно отображаться в списке вложений.


        вложения. itemId: используется только в том случае, если для Type задано значение Item. Идентификатор элемента EWS существующего письма, которое нужно вложить в новое сообщение. Это строка длиной до 100 символов.
      type:
      - any
- uid: Outlook_1_7.Office.Mailbox.getCallbackTokenAsync
  summary: >-
    Возвращает строку, содержащую маркер, который используется для вызова интерфейсов REST API или веб-служб Exchange.


    Метод getCallbackTokenAsync совершает асинхронный вызов, чтобы получить непрозрачный маркер с сервера Exchange Server, на котором размещен почтовый ящик пользователя. Время существования маркера обратного вызова составляет 5 минут.


    *Маркеры REST*


    Когда запрашивается маркер REST (Options. IsTrue = true), полученный маркер не будет работать для проверки подлинности вызовов веб-служб Exchange. Маркер будет ограничен в области для доступа только для чтения к текущему элементу и его вложениям, если надстройка не указала разрешение ReadWriteMailbox в манифесте. Если задано разрешение ReadWriteMailbox, полученный маркер предоставит доступ для чтения и записи к почте, календарю и контактам, включая возможность отправки почты.


    Надстройка должна использовать свойство Рестурл, чтобы определить правильный URL-адрес, используемый при вызовах REST API.


    *Маркеры EWS*


    Когда запрашивается маркер EWS (Options. IsFalse = false), полученный маркер не будет работать для проверки подлинности вызовов REST API. Маркер будет ограничен в области действия для доступа к текущему элементу.


    Надстройка должна использовать свойство ewsUrl, чтобы определить правильный URL-адрес, используемый при совершении вызовов EWS.


    **Примечание**: рекомендуется по возможности использовать API REST вместо веб-служб Exchange.


    \[[Набор API: Mailbox 1,5](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: >-
    <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>ReadItem</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>

    ####Примеры


    ```javascript

    function getCallbackToken() {
        var options = {
            isRest: true,
            asyncContext: { message: 'Hello World!' }
        };

        Office.context.mailbox.getCallbackTokenAsync(options, cb);
    }


    function cb(asyncResult) {
        var token = asyncResult.value;
    }

    ```
  name: getCallbackTokenAsync(options, callback)
  fullName: getCallbackTokenAsync(options, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getCallbackTokenAsync(options: Office.AsyncContextOptions & { isRest?: boolean }, callback: (asyncResult: Office.AsyncResult<string>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: options
      description: 'Объектный литерал, содержащий одно или несколько из указанных ниже свойств. Опускайте: определяет, будет ли предоставленный маркер использоваться для REST API Outlook или веб-служб Exchange. Значение по умолчанию — False. asyncContext: любые данные о состоянии, которые передаются в асинхронный метод.'
      type:
      - 'Office.AsyncContextOptions & { isRest?: boolean }'
    - id: callback
      description: После выполнения метода функция, переданная в параметре callback, вызывается с помощью одного параметра типа Office. AsyncResult. Маркер указывается в виде строки в свойстве `asyncResult.value`. Если возникла ошибка, то `asyncResult.error` свойства и `asyncResult.diagnostics` могут содержать дополнительные сведения.
      type:
      - '(asyncResult: Office.AsyncResult<string>) => void'
- uid: Outlook_1_7.Office.Mailbox.getCallbackTokenAsync_1
  summary: >-
    Получает строку, содержащую маркер, используемый для получения вложения или элемента с Exchange Server.


    Метод getCallbackTokenAsync совершает асинхронный вызов, чтобы получить непрозрачный маркер с сервера Exchange Server, на котором размещен почтовый ящик пользователя. Время существования маркера обратного вызова составляет 5 минут.


    Вы можете передать сторонней системе маркер и идентификатор вложения или элемента. Сторонняя система использует этот маркер как маркер авторизации, чтобы вызвать операцию GetAttachment или GetItem веб-служб Exchange для возврата вложения или элемента. Например, вы можете создать удаленную службу, чтобы получить вложения из выбранного элемента.


    У вашего приложения должно быть разрешение ReadItem, указанное в его манифесте, для вызова метода getCallbackTokenAsync в режиме чтения.


    В режиме создания необходимо вызвать метод saveAsync, чтобы получить идентификатор элемента, передаваемый в метод getCallbackTokenAsync. У вашего приложения должны быть разрешения ReadWriteItem для вызова метода saveAsync.


    \[[Набор API: Mailbox 1,3](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: >-
    <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>ReadItem</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>

    ####Примеры


    ```javascript

    function getCallbackToken() {
        Office.context.mailbox.getCallbackTokenAsync(cb);
    }


    function cb(asyncResult) {
        var token = asyncResult.value;
    }

    ```
  name: getCallbackTokenAsync(callback, userContext)
  fullName: getCallbackTokenAsync(callback, userContext)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getCallbackTokenAsync(callback: (asyncResult: Office.AsyncResult<string>) => void, userContext?: any): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: callback
      description: После выполнения метода функция, переданная в параметре callback, вызывается с помощью одного параметра типа Office. AsyncResult. Маркер указывается в виде строки в свойстве `asyncResult.value`. Если возникла ошибка, то `asyncResult.error` свойства и `asyncResult.diagnostics` могут содержать дополнительные сведения.
      type:
      - '(asyncResult: Office.AsyncResult<string>) => void'
    - id: userContext
      description: Необязательное свойство. Данные о состоянии, передаваемые в асинхронный метод.
      type:
      - any
- uid: Outlook_1_7.Office.Mailbox.getUserIdentityTokenAsync
  summary: >-
    Получает маркер, идентифицирующий пользователя и надстройку Office.


    Маркер указывается в виде строки в свойстве asyncResult.value.


    \[[Набор API: Mailbox 1,0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: >-
    <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>ReadItem</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>


    Метод getUserIdentityTokenAsync возвращает маркер, который можно использовать для идентификации и [проверки подлинности надстройки и пользователя в сторонней системе](https://docs.microsoft.com/outlook/add-ins/authentication)<!-- -->.

    #### <a name="examples"></a>Примеры


    ```javascript

    function getIdentityToken() {
        Office.context.mailbox.getUserIdentityTokenAsync(cb);
    }


    function cb(asyncResult) {
        var token = asyncResult.value;
    }

    ```
  name: getUserIdentityTokenAsync(callback, userContext)
  fullName: getUserIdentityTokenAsync(callback, userContext)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'getUserIdentityTokenAsync(callback: (asyncResult: Office.AsyncResult<string>) => void, userContext?: any): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: callback
      description: После выполнения метода функция, переданная в параметре callback, вызывается с помощью одного параметра типа Office. AsyncResult. Маркер указывается в виде строки в свойстве `asyncResult.value`. Если возникла ошибка, то `asyncResult.error` свойства и `asyncResult.diagnostics` могут содержать дополнительные сведения.
      type:
      - '(asyncResult: Office.AsyncResult<string>) => void'
    - id: userContext
      description: Необязательное свойство. Данные о состоянии, передаваемые в асинхронный метод.\|
      type:
      - any
- uid: Outlook_1_7.Office.Mailbox.makeEwsRequestAsync
  summary: >-
    Выполняет асинхронный запрос к службе веб-служб Exchange (EWS) на сервере Exchange, на котором размещается почтовый ящик пользователя.


    В таких случаях надстройка должна использовать REST API для доступа к почтовому ящику пользователя.


    Метод makeEwsRequestAsync отправляет запрос EWS от имени надстройки в Exchange.


    С помощью метода makeEwsRequestAsync невозможно запрашивать элементы, связанные с папкой.


    В запросе XML должна быть указана кодировка UTF-8. &lt;<!-- -->_Км_ксмл Version = "1.0" Encoding = "UTF – 8"?<!-- -->&gt;


    Надстройка должна иметь разрешение ReadWriteMailbox на использование метода makeEwsRequestAsync. Для получения сведений об использовании разрешения ReadWriteMailbox и операций EWS, которые можно вызывать с помощью метода makeEwsRequestAsync, обратитесь к разделу [Определение разрешений для](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)<!-- -->почтового ящика пользователя по почтовым надстройкам.


    Результат XML вызова EWS указывается в виде строки в свойстве asyncResult.value. Если размер результата превышает 1 МБ, возвращается сообщение об ошибке.


    **Примечание**: Этот метод не поддерживается в следующих сценариях:


    - В Outlook для iOS или Outlook для Android.


    - Когда надстройка загружается в почтовый ящик Gmail.


    **Note**: администратор сервера должен установить для OAuthAuthentication значение true в каталоге Client Access Server EWS, чтобы разрешить методу makeEwsRequestAsync выполнять запросы EWS.


    *Различия версий*


    При использовании метода makeEwsRequestAsync в почтовых приложениях, которые выполняются в Outlook версии ниже 15.0.4535.1004, следует указывать кодировку ISO-8859-1.


    `<?xml version="1.0" encoding="iso-8859-1"?>`


    Значение кодировки не нужно указывать, если почтовое приложение выполняется в Outlook в Интернете. Чтобы определить, выполняется ли приложение в Outlook или Outlook в Интернете, используйте свойство mailbox.diagnostics.hostName. Используемую версию Outlook можно определить с помощью свойства mailbox.diagnostics.hostVersion.


    \[[Набор API: Mailbox 1,0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: >-
    <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>ReadWriteMailbox</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>

    ####Примеры


    ```javascript

    function getSubjectRequest(id) {
        // Return a GetItem operation request for the subject of the specified item.
        var request =
            '<?xml version="1.0" encoding="utf-8"?>' +
            '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"' +
            '               xmlns:xsd="http://www.w3.org/2001/XMLSchema"' +
            '               xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"' +
            '               xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">' +
            '  <soap:Header>' +
            '    <RequestServerVersion Version="Exchange2013" xmlns="http://schemas.microsoft.com/exchange/services/2006/types" soap:mustUnderstand="0" />' +
            '  </soap:Header>' +
            '  <soap:Body>' +
            '    <GetItem xmlns="http://schemas.microsoft.com/exchange/services/2006/messages">' +
            '      <ItemShape>' +
            '        <t:BaseShape>IdOnly</t:BaseShape>' +
            '        <t:AdditionalProperties>' +
            '            <t:FieldURI FieldURI="item:Subject"/>' +
            '        </t:AdditionalProperties>' +
            '      </ItemShape>' +
            '      <ItemIds><t:ItemId Id="' + id + '"/></ItemIds>' +
            '    </GetItem>' +
            '  </soap:Body>' +
            '</soap:Envelope>';

        return request;
    }


    function sendRequest() {
        // Create a local variable that contains the mailbox.
        Office.context.mailbox.makeEwsRequestAsync(
            getSubjectRequest(mailbox.item.itemId), callback);
    }


    function callback(asyncResult)  {
        var result = asyncResult.value;
        var context = asyncResult.asyncContext;

        // Process the returned response here.
    }

    ```
  name: makeEwsRequestAsync(data, callback, userContext)
  fullName: makeEwsRequestAsync(data, callback, userContext)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'makeEwsRequestAsync(data: any, callback: (asyncResult: Office.AsyncResult<string>) => void, userContext?: any): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: data
      description: Запрос EWS.
      type:
      - any
    - id: callback
      description: После выполнения метода функция, переданная в параметре callback, вызывается с помощью одного параметра типа Office. AsyncResult. `value` Свойство Result представляет собой XML-код запроса EWS, предоставленный в виде строки. Если размер результата превышает 1 МБ, возвращается сообщение об ошибке.
      type:
      - '(asyncResult: Office.AsyncResult<string>) => void'
    - id: userContext
      description: Необязательное свойство. Данные о состоянии, передаваемые в асинхронный метод.
      type:
      - any
- uid: Outlook_1_7.Office.Mailbox.removeHandlerAsync
  summary: >-
    Удаляет обработчиков для поддерживаемого типа события.


    В настоящее время единственным поддерживаемым типом события `Office.EventType.ItemChanged` <!-- -->является.


    \[[Набор API: Mailbox 1,5](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>ReadItem</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>
  name: removeHandlerAsync(eventType, options, callback)
  fullName: removeHandlerAsync(eventType, options, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'removeHandlerAsync(eventType: Office.EventType, options?: Office.AsyncContextOptions, callback?: (asyncResult: Office.AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: eventType
      description: Событие, которое должно отменить обработчик.
      type:
      - Office.EventType
    - id: options
      description: Необязательное свойство. Предоставляет параметр для сохранения данных контекста любого типа без изменений для использования при обратном вызове.
      type:
      - Office.AsyncContextOptions
    - id: callback
      description: Необязательное свойство. После выполнения метода функция, переданная в параметре callback, вызывается с помощью одного параметра типа Office. AsyncResult.
      type:
      - '(asyncResult: Office.AsyncResult<void>) => void'
- uid: Outlook_1_7.Office.Mailbox.removeHandlerAsync_1
  summary: >-
    Удаляет обработчиков для поддерживаемого типа события.


    В настоящее время единственным поддерживаемым типом события `Office.EventType.ItemChanged` <!-- -->является.


    \[[Набор API: Mailbox 1,5](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>ReadItem</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>
  name: removeHandlerAsync(eventType, callback)
  fullName: removeHandlerAsync(eventType, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'removeHandlerAsync(eventType: Office.EventType, callback?: (asyncResult: Office.AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: eventType
      description: Событие, которое должно отменить обработчик.
      type:
      - Office.EventType
    - id: callback
      description: Необязательное свойство. После выполнения метода функция, переданная в параметре callback, вызывается с помощью одного параметра типа Office. AsyncResult.
      type:
      - '(asyncResult: Office.AsyncResult<void>) => void'
- uid: Outlook_1_7.Office.Mailbox.diagnostics
  summary: >-
    Предоставляет надстройке Outlook диагностические сведения.


    Содержит следующие элементы:


    - hostName (строка): строка, представляющая имя ведущего приложения. Это одно из следующих значений: Outlook, Mac Outlook, Аутлукиос или OutlookWebApp.


    - hostVersion (строка): строка, представляющая версию ведущего приложения или сервера Exchange Server. Если почтовые надстройки работают в клиенте Outlook для настольных компьютеров или Outlook для iOS, свойство hostVersion Возвращает версию ведущего приложения, Outlook. В Outlook Web App свойство возвращает версию сервера Exchange. Примером является строка 15.0.468.0.


    - OWAView (MailboxEnums. OWAView или String): перечисление (или строковый литерал), представляющее текущее представление Outlook Web App. Если Outlook Web App — не ведущее приложение, при получении доступа к этому свойству будет выдаваться значение undefined. В Outlook Web App есть три представления (OneColumn — отображаются, когда экран сужается, TwoColumns — отображается, когда экран шире, и ThreeColumns отображается, когда экран размещается в ширину), что соответствует ширине экрана и окна, а также по числу столбцов для отображения.


    Дополнительные сведения находятся в разделе [Office. Diagnostics](xref:Outlook_1_7.Office.Diagnostics)<!-- -->.


    \[[Набор API: Mailbox 1,0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>ReadItem</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>
  name: diagnostics
  fullName: diagnostics
  langs:
  - typeScript
  type: property
  syntax:
    content: 'diagnostics: Diagnostics;'
    return:
      type:
      - Diagnostics
- uid: Outlook_1_7.Office.Mailbox.ewsUrl
  summary: >-
    Получает URL-адрес конечной точки веб-служб Exchange (EWS) для этой учетной записи электронной почты. Только в режиме чтения.


    У вашего приложения должно быть разрешение ReadItem, указанное в его манифесте, для вызова члена ewsUrl в режиме чтения.


    В режиме создания необходимо вызвать метод saveAsync, прежде чем можно будет использовать элемент ewsUrl. У вашего приложения должны быть разрешения ReadWriteItem для вызова метода saveAsync.


    \[[Набор API: Mailbox 1,0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: >-
    <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>ReadItem</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>


    Удаленная служба может использовать значение ewsUrl для выполнения вызовов EWS в почтовый ящик пользователя. Например, вы можете создать удаленную службу для [получения вложений из выбранного элемента](https://docs.microsoft.com/outlook/add-ins/get-attachments-of-an-outlook-item)<!-- -->.


    **Примечание**: этот элемент не поддерживается в Outlook для iOS или Outlook для Android.
  name: ewsUrl
  fullName: ewsUrl
  langs:
  - typeScript
  type: property
  syntax:
    content: 'ewsUrl: string;'
    return:
      type:
      - string
- uid: Outlook_1_7.Office.Mailbox.item
  summary: Элемент почтового ящика. В зависимости от контекста, в котором открытая надстройка, элемент может иметь любое количество типов. Если вы хотите увидеть IntelliSense только для определенного типа, необходимо привести этот элемент к одному из следующих `ItemCompose` <!-- -->:, `ItemRead` <!-- -->, `MessageCompose` <!-- -->, `MessageRead` <!-- --> `AppointmentCompose` <!-- -->,,`AppointmentRead`
  name: item
  fullName: item
  langs:
  - typeScript
  type: property
  syntax:
    content: 'item: Item & ItemCompose & ItemRead & MessageRead & MessageCompose & AppointmentRead & AppointmentCompose;'
    return:
      type:
      - Item & ItemCompose & ItemRead & MessageRead & MessageCompose & AppointmentRead & AppointmentCompose
- uid: Outlook_1_7.Office.Mailbox.restUrl
  summary: >-
    Возвращает URL-адрес конечной точки REST для этой учетной записи электронной почты.


    У вашего приложения должно быть разрешение ReadItem, указанное в его манифесте, для вызова члена Рестурл в режиме чтения.


    В режиме создания необходимо вызвать метод saveAsync, прежде чем можно будет использовать элемент Рестурл. У вашего приложения должны быть разрешения ReadWriteItem для вызова метода saveAsync.


    \[[Набор API: Mailbox 1,5](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]
  remarks: >-
    <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>ReadItem</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>


    Значение Рестурл можно использовать, чтобы совершать вызовы [REST API](https://docs.microsoft.com/outlook/rest/) для почтового ящика пользователя.
  name: restUrl
  fullName: restUrl
  langs:
  - typeScript
  type: property
  syntax:
    content: 'restUrl: string;'
    return:
      type:
      - string
- uid: Outlook_1_7.Office.Mailbox.userProfile
  summary: >-
    Сведения о пользователе, связанном с почтовым ящиком. К ним относятся тип учетной записи, отображаемое имя, адрес электронной почты и часовой пояс.


    Дополнительные сведения находятся в [пакете Office. UserProfile](xref:Outlook_1_7.Office.UserProfile)
  name: userProfile
  fullName: userProfile
  langs:
  - typeScript
  type: property
  syntax:
    content: 'userProfile: UserProfile;'
    return:
      type:
      - UserProfile
