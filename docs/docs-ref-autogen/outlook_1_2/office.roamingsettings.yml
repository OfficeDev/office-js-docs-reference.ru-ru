### YamlMime:UniversalReference
ms.openlocfilehash: fcee20f459ecf03541a8dbbe3026e7387f7e2de6
ms.sourcegitcommit: 6c48441b8be51d3a9d7dc836e386230a155feceb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/22/2019
ms.locfileid: "30199266"
items:
- uid: Outlook_1_2.Office.RoamingSettings
  summary: >-
    <span data-ttu-id="dd08e-p101">Параметры, созданные с помощью методов объекта RoamingSettings, сохраняются на уровне надстройки и на уровне пользователя. Таким образом, они доступны исключительно надстройке, с помощью которой они созданы, и только из почтового ящика пользователя, в котором они сохранены.</span><span class="sxs-lookup"><span data-stu-id="dd08e-p101">The settings created by using the methods of the RoamingSettings object are saved per add-in and per user. That is, they are available only to the add-in that created them, and only from the user's mail box in which they are saved.</span></span>


    <span data-ttu-id="dd08e-p102">Хотя API "Надстройка Outlook" предоставляет доступ к этим параметрам только надстройке, с помощью которой они созданы, эти параметры не следует считать безопасным способом хранения. К ним можно получить доступ с помощью веб-служб Exchange или расширенного MAPI. Их не следует использовать для хранения конфиденциальных сведений, таких как учетные данные пользователя или маркеры безопасности.</span><span class="sxs-lookup"><span data-stu-id="dd08e-p102">While the Outlook Add-in API limits access to these settings to only the add-in that created them, these settings should not be considered secure storage. They can be accessed by Exchange Web Services or Extended MAPI. They should not be used to store sensitive information such as user credentials or security tokens.</span></span>


    <span data-ttu-id="dd08e-106">Имя параметра — это String, а значение может быть String, Number, Boolean, null, Object или Array.</span><span class="sxs-lookup"><span data-stu-id="dd08e-106">The name of a setting is a String, while the value can be a String, Number, Boolean, null, Object, or Array.</span></span>


    <span data-ttu-id="dd08e-107">К объекту RoamingSettings можно получить доступ с помощью свойства roamingSettings в пространстве имен Office.context.</span><span class="sxs-lookup"><span data-stu-id="dd08e-107">The RoamingSettings object is accessible via the roamingSettings property in the Office.context namespace.</span></span>


    <span data-ttu-id="dd08e-108">**Важно!** объект roamingSettings инициализируется из материализованного хранилища только при первой загрузке надстройки.</span><span class="sxs-lookup"><span data-stu-id="dd08e-108">**Important**: The RoamingSettings object is initialized from the persisted storage only when the add-in is first loaded.</span></span> <span data-ttu-id="dd08e-109">Для областей задач это означает, что она инициализируется только при первом открытии области задач.</span><span class="sxs-lookup"><span data-stu-id="dd08e-109">For task panes, this means that it is only initialized when the task pane first opens.</span></span> <span data-ttu-id="dd08e-110">Если область задач переходит к другой странице или Перезагружает текущую страницу, объект в памяти сбрасывается в исходные значения, даже если ваша надстройка сохраняет изменения.</span><span class="sxs-lookup"><span data-stu-id="dd08e-110">If the task pane navigates to another page or reloads the current page, the in-memory object is reset to its initial values, even if your add-in has persisted changes.</span></span> <span data-ttu-id="dd08e-111">Сохраненные изменения не будут доступны до тех пор, пока область задач не будет закрыта и открыта повторно.</span><span class="sxs-lookup"><span data-stu-id="dd08e-111">The persisted changes will not be available until the task pane is closed and reopened.</span></span>


    <span data-ttu-id="dd08e-112">\[[Набор API: Mailbox 1,0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="dd08e-112">\[ [API set: Mailbox 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: >-
    <table> <tr><td>[<span data-ttu-id="dd08e-113">Минимальный уровень разрешений</span><span class="sxs-lookup"><span data-stu-id="dd08e-113">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="dd08e-114">С ограничениями</span><span class="sxs-lookup"><span data-stu-id="dd08e-114">Restricted</span></span></td></tr> <tr><td>[<span data-ttu-id="dd08e-115">Применимый режим Outlook</span><span class="sxs-lookup"><span data-stu-id="dd08e-115">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="dd08e-116">Создание или чтение</span><span class="sxs-lookup"><span data-stu-id="dd08e-116">Compose or Read</span></span></td></tr> </table><span data-ttu-id="dd08e-117">

    ####Примеры</span><span class="sxs-lookup"><span data-stu-id="dd08e-117">

    #### Examples</span></span>


    ```javascript

    // Get the current value of the 'myKey' setting.

    var value = Office.context.roamingSettings.get('myKey');

    // Update the value of the 'myKey' setting.

    Office.context.roamingSettings.set('myKey', 'Hello World!');

    // Persist the change.

    Office.context.roamingSettings.saveAsync();

    ```
  name: Office.RoamingSettings
  fullName: Office.RoamingSettings
  langs:
  - typeScript
  type: interface
  package: Outlook_1_2
  children:
  - Outlook_1_2.Office.RoamingSettings.get
  - Outlook_1_2.Office.RoamingSettings.remove
  - Outlook_1_2.Office.RoamingSettings.saveAsync
  - Outlook_1_2.Office.RoamingSettings.set
- uid: Outlook_1_2.Office.RoamingSettings.get
  summary: >-
    <span data-ttu-id="dd08e-118">Извлекает указанный параметр.</span><span class="sxs-lookup"><span data-stu-id="dd08e-118">Retrieves the specified setting.</span></span>


    <span data-ttu-id="dd08e-119">\[[Набор API: Mailbox 1,0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="dd08e-119">\[ [API set: Mailbox 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: <table> <tr><td>[<span data-ttu-id="dd08e-120">Минимальный уровень разрешений</span><span class="sxs-lookup"><span data-stu-id="dd08e-120">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="dd08e-121">С ограничениями</span><span class="sxs-lookup"><span data-stu-id="dd08e-121">Restricted</span></span></td></tr> <tr><td>[<span data-ttu-id="dd08e-122">Применимый режим Outlook</span><span class="sxs-lookup"><span data-stu-id="dd08e-122">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="dd08e-123">Создание или чтение</span><span class="sxs-lookup"><span data-stu-id="dd08e-123">Compose or Read</span></span></td></tr> </table>
  name: get(name)
  fullName: get(name)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'get(name: string): any;'
    return:
      type:
      - any
      description: '<span data-ttu-id="dd08e-124">Тип: \| строковый \| номер \| логический \| массив объектов</span><span class="sxs-lookup"><span data-stu-id="dd08e-124">Type: String \| Number \| Boolean \| Object \| Array</span></span>'
    parameters:
    - id: name
      description: <span data-ttu-id="dd08e-125">Имя извлекаемого параметра с учетом регистра.</span><span class="sxs-lookup"><span data-stu-id="dd08e-125">The case-sensitive name of the setting to retrieve.</span></span>
      type:
      - string
- uid: Outlook_1_2.Office.RoamingSettings.remove
  summary: >-
    <span data-ttu-id="dd08e-126">Удаляет указанный параметр</span><span class="sxs-lookup"><span data-stu-id="dd08e-126">Removes the specified setting</span></span>


    <span data-ttu-id="dd08e-127">\[[Набор API: Mailbox 1,0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="dd08e-127">\[ [API set: Mailbox 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: <table> <tr><td>[<span data-ttu-id="dd08e-128">Минимальный уровень разрешений</span><span class="sxs-lookup"><span data-stu-id="dd08e-128">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="dd08e-129">С ограничениями</span><span class="sxs-lookup"><span data-stu-id="dd08e-129">Restricted</span></span></td></tr> <tr><td>[<span data-ttu-id="dd08e-130">Применимый режим Outlook</span><span class="sxs-lookup"><span data-stu-id="dd08e-130">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="dd08e-131">Создание или чтение</span><span class="sxs-lookup"><span data-stu-id="dd08e-131">Compose or Read</span></span></td></tr> </table>
  name: remove(name)
  fullName: remove(name)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'remove(name: string): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: name
      description: <span data-ttu-id="dd08e-132">Имя удаляемого параметра с учетом регистра</span><span class="sxs-lookup"><span data-stu-id="dd08e-132">The case-sensitive name of the setting to remove.</span></span>
      type:
      - string
- uid: Outlook_1_2.Office.RoamingSettings.saveAsync
  summary: >-
    <span data-ttu-id="dd08e-133">Сохраняет параметры.</span><span class="sxs-lookup"><span data-stu-id="dd08e-133">Saves the settings.</span></span>


    <span data-ttu-id="dd08e-p104">Все параметры, ранее сохраненные надстройкой, загружаются при ее инициализации, поэтому на протяжении всего сеанса можно использовать только методы set и get для работы с копией контейнера свойств в памяти. Если требуется сохранить параметры, чтобы они были доступны при следующем использовании надстройки, воспользуйтесь методом saveAsync.</span><span class="sxs-lookup"><span data-stu-id="dd08e-p104">Any settings previously saved by an add-in are loaded when it is initialized, so during the lifetime of the session you can just use the set and get methods to work with the in-memory copy of the settings property bag. When you want to persist the settings so that they are available the next time the add-in is used, use the saveAsync method.</span></span>


    <span data-ttu-id="dd08e-136">\[[Набор API: Mailbox 1,0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="dd08e-136">\[ [API set: Mailbox 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: <table> <tr><td>[<span data-ttu-id="dd08e-137">Минимальный уровень разрешений</span><span class="sxs-lookup"><span data-stu-id="dd08e-137">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="dd08e-138">С ограничениями</span><span class="sxs-lookup"><span data-stu-id="dd08e-138">Restricted</span></span></td></tr> <tr><td>[<span data-ttu-id="dd08e-139">Применимый режим Outlook</span><span class="sxs-lookup"><span data-stu-id="dd08e-139">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="dd08e-140">Создание или чтение</span><span class="sxs-lookup"><span data-stu-id="dd08e-140">Compose or Read</span></span></td></tr> </table>
  name: saveAsync(callback)
  fullName: saveAsync(callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'saveAsync(callback?: (asyncResult: Office.AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: callback
      description: <span data-ttu-id="dd08e-141">Необязательное свойство.</span><span class="sxs-lookup"><span data-stu-id="dd08e-141">Optional.</span></span> <span data-ttu-id="dd08e-142">После выполнения метода функция, переданная в параметре callback, вызывается с помощью одного параметра типа Office. AsyncResult.</span><span class="sxs-lookup"><span data-stu-id="dd08e-142">When the method completes, the function passed in the callback parameter is called with a single parameter of type Office.AsyncResult.</span></span>
      type:
      - '(asyncResult: Office.AsyncResult<void>) => void'
- uid: Outlook_1_2.Office.RoamingSettings.set
  summary: >-
    <span data-ttu-id="dd08e-143">Устанавливает или создает указанный параметр.</span><span class="sxs-lookup"><span data-stu-id="dd08e-143">Sets or creates the specified setting.</span></span>


    <span data-ttu-id="dd08e-p106">Метод set создает новый параметр с указанным именем, если он еще не существует, или устанавливает существующий параметр с указанным именем. Значение сохраняется в документе как сериализованное представление JSON с его типом данных.</span><span class="sxs-lookup"><span data-stu-id="dd08e-p106">The set method creates a new setting of the specified name if it does not already exist, or sets an existing setting of the specified name. The value is stored in the document as the serialized JSON representation of its data type.</span></span>


    <span data-ttu-id="dd08e-146">Для параметров каждой надстройки доступен максимум 32 КБ.</span><span class="sxs-lookup"><span data-stu-id="dd08e-146">A maximum of 32KB is available for the settings of each add-in.</span></span>


    <span data-ttu-id="dd08e-147">Любые изменения, внесенные в параметры с помощью функции set, будут сохранены на сервере только после вызова функции saveAsync.</span><span class="sxs-lookup"><span data-stu-id="dd08e-147">Any changes made to settings using the set function will not be saved to the server until the saveAsync function is called.</span></span>


    <span data-ttu-id="dd08e-148">\[[Набор API: Mailbox 1,0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)\]</span><span class="sxs-lookup"><span data-stu-id="dd08e-148">\[ [API set: Mailbox 1.0](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets) \]</span></span>
  remarks: <table> <tr><td>[<span data-ttu-id="dd08e-149">Минимальный уровень разрешений</span><span class="sxs-lookup"><span data-stu-id="dd08e-149">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="dd08e-150">С ограничениями</span><span class="sxs-lookup"><span data-stu-id="dd08e-150">Restricted</span></span></td></tr> <tr><td>[<span data-ttu-id="dd08e-151">Применимый режим Outlook</span><span class="sxs-lookup"><span data-stu-id="dd08e-151">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="dd08e-152">Создание или чтение</span><span class="sxs-lookup"><span data-stu-id="dd08e-152">Compose or Read</span></span></td></tr> </table>
  name: set(name, value)
  fullName: set(name, value)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'set(name: string, value: any): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: name
      description: <span data-ttu-id="dd08e-153">Имя устанавливаемого или создаваемого параметра с учетом регистра.</span><span class="sxs-lookup"><span data-stu-id="dd08e-153">The case-sensitive name of the setting to set or create.</span></span>
      type:
      - string
    - id: value
      description: <span data-ttu-id="dd08e-154">Задает значение для сохранения.</span><span class="sxs-lookup"><span data-stu-id="dd08e-154">Specifies the value to be stored.</span></span>
      type:
      - any
