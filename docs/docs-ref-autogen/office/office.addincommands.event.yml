### YamlMime:UniversalReference
ms.openlocfilehash: 45f7cc7ea0d9cec7b247ef8ace1eccdb788bbcc1
ms.sourcegitcommit: c1149d24b38f20daf9ce690cd0761ec1ceb7333d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/17/2018
ms.locfileid: "25580832"
items:
- uid: office.Office.AddinCommands.Event
  summary: <span data-ttu-id="2288a-p101">Объект event передается как параметр для функций надстройки, вызванных кнопками в режиме без пользовательского интерфейса. Этот объект позволяет надстройке определить нажатую кнопку и уведомить узел о завершении обработки.</span><span class="sxs-lookup"><span data-stu-id="2288a-p101">The event object is passed as a parameter to add-in functions invoked by UI-less command buttons. The object allows the add-in to identify which button was clicked and to signal the host that it has completed its processing.</span></span>
  remarks: >-
    <table><tr><td><span data-ttu-id="2288a-103">Тип надстройки</span><span class="sxs-lookup"><span data-stu-id="2288a-103">Add-in type</span></span></td><td><span data-ttu-id="2288a-104">Надстройки области задач, надстройки Outlook, контентные надстройки</span><span class="sxs-lookup"><span data-stu-id="2288a-104">Content, task pane, Outlook</span></span></td></tr>


    <tr><td>[<span data-ttu-id="2288a-105">Минимальный уровень разрешений</span><span class="sxs-lookup"><span data-stu-id="2288a-105"> Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="2288a-106">Restricted</span><span class="sxs-lookup"><span data-stu-id="2288a-106">Restricted</span></span></td></tr>


    <tr><td>[<span data-ttu-id="2288a-107">Применимые режим Outlook</span><span class="sxs-lookup"><span data-stu-id="2288a-107"> Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="2288a-108">Создания и чтения</span><span class="sxs-lookup"><span data-stu-id="2288a-108">Compose or Read</span></span></td></tr></table>
  name: Office.AddinCommands.Event
  fullName: office.Office.AddinCommands.Event
  langs:
  - typeScript
  type: interface
  package: office
  children:
  - office.Office.AddinCommands.Event.completed
  - office.Office.AddinCommands.Event.source
- uid: office.Office.AddinCommands.Event.completed
  summary: >-
    <span data-ttu-id="2288a-109">Указывает на то, что надстройка завершила обработку, активированную с помощью кнопки надстройки или обработчика события.</span><span class="sxs-lookup"><span data-stu-id="2288a-109">Indicates that the add-in has completed processing that was triggered by an add-in command button or event handler.</span></span>


    <span data-ttu-id="2288a-p102">Этот метод необходимо вызывать в конце функции, которую вызвали с помощью команды надстройки, определенной с использованием элемента Action, для атрибута xsi:type которого задано значение ExecuteFunction. При вызове этого метода клиент узла узнает, что функция завершена и что он может очистить любое состояние, связанное с вызовом функции. Например, если пользователь закроет Outlook до вызова этого метода, Outlook предупредит его, что функция по-прежнему выполняется.</span><span class="sxs-lookup"><span data-stu-id="2288a-p102">This method must be called at the end of a function which was invoked by an add-in command defined with an Action element with an xsi:type attribute set to ExecuteFunction. Calling this method signals the host client that the function is complete and that it can clean up any state involved with invoking the function. For example, if the user closes Outlook before this method is called, Outlook will warn that a function is still executing.</span></span>


    <span data-ttu-id="2288a-113">Этот метод необходимо вызывать в обработчике событий, добавленном с помощью метода Office.context.mailbox.addHandlerAsync, по завершении обработки события.</span><span class="sxs-lookup"><span data-stu-id="2288a-113">This method must be called in an event handler added via Office.context.mailbox.addHandlerAsync after completing processing of the event.</span></span>


    <span data-ttu-id="2288a-114">\[[Набор API-Интерфейсов: почтовый ящик 1.3](/office/dev/add-ins/reference/javascript-api-for-office)\]</span><span class="sxs-lookup"><span data-stu-id="2288a-114">\[ [API set: Mailbox 1.3](/office/dev/add-ins/reference/javascript-api-for-office) \]</span></span>
  remarks: >-
    <table><tr><td>[<span data-ttu-id="2288a-115">Минимальный уровень разрешений</span><span class="sxs-lookup"><span data-stu-id="2288a-115"> Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="2288a-116">Restricted</span><span class="sxs-lookup"><span data-stu-id="2288a-116">Restricted</span></span></td></tr>


    <tr><td>[<span data-ttu-id="2288a-117">Применимые режим Outlook</span><span class="sxs-lookup"><span data-stu-id="2288a-117"> Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="2288a-118">Создание или чтение</span><span class="sxs-lookup"><span data-stu-id="2288a-118">Compose or read</span></span></td></tr></table>


    <span data-ttu-id="2288a-119">**Сведения о поддержке**</span><span class="sxs-lookup"><span data-stu-id="2288a-119">**Support details**</span></span>


    <span data-ttu-id="2288a-p103">Заглавная буква Y в следующей матрице указывает на то, что этот метод поддерживается в соответствующем ведущем приложении Office. Пустая ячейка означает, что ведущее приложение Office не поддерживает этот метод.</span><span class="sxs-lookup"><span data-stu-id="2288a-p103">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


    <span data-ttu-id="2288a-122">Дополнительные сведения о требованиях к приложения и сервера узла Office можно [требования для запуска надстроек Office](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span><span class="sxs-lookup"><span data-stu-id="2288a-122">For more information about Office host application and server requirements, see [ Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="2288a-123">*Поддерживаемые ведущие приложения на разных платформах*</span><span class="sxs-lookup"><span data-stu-id="2288a-123">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="2288a-124">Office для компьютера с Windows</span><span class="sxs-lookup"><span data-stu-id="2288a-124">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="2288a-125">Office Online (в браузере)</span><span class="sxs-lookup"><span data-stu-id="2288a-125">Office Online (in browser)</span></span> </th><th> <span data-ttu-id="2288a-126">Office для iPad</span><span class="sxs-lookup"><span data-stu-id="2288a-126">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id="2288a-127"><strong>Excel</strong></span><span class="sxs-lookup"><span data-stu-id="2288a-127"><strong> Excel </strong></span></span></td><td> <span data-ttu-id="2288a-128">Да</span><span class="sxs-lookup"><span data-stu-id="2288a-128">Y</span></span> </td><td> <span data-ttu-id="2288a-129">Да</span><span class="sxs-lookup"><span data-stu-id="2288a-129">Y</span></span> </td><td> <span data-ttu-id="2288a-130">Да</span><span class="sxs-lookup"><span data-stu-id="2288a-130">Y</span></span> </td></tr> <tr><td><span data-ttu-id="2288a-131"><strong>Outlook</strong></span><span class="sxs-lookup"><span data-stu-id="2288a-131"><strong> Outlook </strong></span></span></td><td> <span data-ttu-id="2288a-132">Y (почтового ящика 1.3)</span><span class="sxs-lookup"><span data-stu-id="2288a-132">Y (Mailbox 1.3)</span></span> </td><td> </td><td> </td></tr> <tr><td><span data-ttu-id="2288a-133"><strong>PowerPoint</strong></span><span class="sxs-lookup"><span data-stu-id="2288a-133"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id="2288a-134">Да</span><span class="sxs-lookup"><span data-stu-id="2288a-134">Y</span></span> </td><td> <span data-ttu-id="2288a-135">Да</span><span class="sxs-lookup"><span data-stu-id="2288a-135">Y</span></span> </td><td> <span data-ttu-id="2288a-136">Да</span><span class="sxs-lookup"><span data-stu-id="2288a-136">Y</span></span> </td></tr> <tr><td><span data-ttu-id="2288a-137"><strong>Word</strong></span><span class="sxs-lookup"><span data-stu-id="2288a-137"><strong> Word </strong></span></span></td><td> <span data-ttu-id="2288a-138">Да</span><span class="sxs-lookup"><span data-stu-id="2288a-138">Y</span></span> </td><td> <span data-ttu-id="2288a-139">Да</span><span class="sxs-lookup"><span data-stu-id="2288a-139">Y</span></span> </td><td> <span data-ttu-id="2288a-140">Да</span><span class="sxs-lookup"><span data-stu-id="2288a-140">Y</span></span> </td></tr> </table>

    #### <a name="examples"></a><span data-ttu-id="2288a-141">Примеры</span><span class="sxs-lookup"><span data-stu-id="2288a-141">Examples</span></span>


    ```javascript

    function processItem (event) {
        // Do some processing

        event.completed();
    }


    // In the following example, the checkMessage function has

    // been registered as an event handler for ItemSend.

    function checkMessage(event) {
        // Get the item being sent
        var outgoingMsg = Office.context.mailbox.item;

        // Check if subject contains "BLOCK"
        outgoingMsg.subject.getAsync(function (result) {
            // Subject is in result.value
            if (result.value.indexOf('BLOCK') != -1) {
                // Value is found, stop send
                event.completed({allowEvent = false});
            } else {
                // Value wasn't found, allow send
                event.completed({allowEvent = true});
            }
        });
    }

    ```
  name: completed(options)
  fullName: office.Office.AddinCommands.Event.completed
  langs:
  - typeScript
  type: method
  syntax:
    content: 'completed(options?: any): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: options
      description: '<span data-ttu-id="2288a-142">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="2288a-142">Optional.</span></span> <span data-ttu-id="2288a-143">Объектный литерал, содержащий одно или несколько из указанных ниже свойств.</span><span class="sxs-lookup"><span data-stu-id="2288a-143">An object literal that contains one or more of the following properties.</span></span> <span data-ttu-id="2288a-144">allowEvent: логическое значение.</span><span class="sxs-lookup"><span data-stu-id="2288a-144">allowEvent: A boolean value.</span></span> <span data-ttu-id="2288a-145">Когда завершенных метод используется для сигнала завершения обработчика событий это значение указывает обрабатываемого события следует продолжить выполнение или отменен.</span><span class="sxs-lookup"><span data-stu-id="2288a-145">When the completed method is used to signal completion of an event handler, this value indicates of the handled event should continue execution or be canceled.</span></span> <span data-ttu-id="2288a-146">Например, надстройки, которая обрабатывает событие ItemSend можно задать allowEvent = false, чтобы отменить отправку сообщения.</span><span class="sxs-lookup"><span data-stu-id="2288a-146">For example, an add-in that handles the ItemSend event can set allowEvent = false to cancel sending of the message.</span></span>'
      type:
      - any
- uid: office.Office.AddinCommands.Event.source
  summary: >-
    <span data-ttu-id="2288a-147">Сведения об элементе управления, который запускается при вызове этой функции.</span><span class="sxs-lookup"><span data-stu-id="2288a-147">Information about the control that triggered calling this function.</span></span>


    <span data-ttu-id="2288a-148">**Сведения о поддержке**</span><span class="sxs-lookup"><span data-stu-id="2288a-148">**Support details**</span></span>


    <span data-ttu-id="2288a-p105">Заглавная буква Y в следующей матрице указывает на то, что это свойство поддерживается в соответствующем ведущем приложении Office. Пустая ячейка означает, что ведущее приложение Office не поддерживает это свойство.</span><span class="sxs-lookup"><span data-stu-id="2288a-p105">A capital Y in the following matrix indicates that this property is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this property.</span></span>


    <span data-ttu-id="2288a-151">Дополнительные сведения о требованиях к приложения и сервера узла Office можно [требования для запуска надстроек Office](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span><span class="sxs-lookup"><span data-stu-id="2288a-151">For more information about Office host application and server requirements, see [ Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="2288a-152">*Поддерживаемые ведущие приложения на разных платформах*</span><span class="sxs-lookup"><span data-stu-id="2288a-152">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="2288a-153">Office для компьютера с Windows</span><span class="sxs-lookup"><span data-stu-id="2288a-153">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="2288a-154">Office Online (в браузере)</span><span class="sxs-lookup"><span data-stu-id="2288a-154">Office Online (in browser)</span></span> </th><th> <span data-ttu-id="2288a-155">Office для iPad</span><span class="sxs-lookup"><span data-stu-id="2288a-155">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id="2288a-156"><strong>Outlook</strong></span><span class="sxs-lookup"><span data-stu-id="2288a-156"><strong> Outlook </strong></span></span></td><td> <span data-ttu-id="2288a-157">Y (почтового ящика 1.3)</span><span class="sxs-lookup"><span data-stu-id="2288a-157">Y (Mailbox 1.3)</span></span> </td><td> </td><td> </td></tr> </table>
  name: source
  fullName: office.Office.AddinCommands.Event.source
  langs:
  - typeScript
  type: property
  syntax:
    content: 'source: Source;'
    return:
      type:
      - office.Office.AddinCommands.Source
      description: "\n#### <a name=\"examples\"></a><span data-ttu-id=\"2288a-158\">Примеры</span><span class=\"sxs-lookup\"><span data-stu-id=\"2288a-158\">Examples</span></span>\n\n```javascript\n// In this example, consider a button defined in an add-in manifest as follows:\n<Control xsi:type=\"Button\" id=\"eventTestButton\">\n    <Label resid=\"eventButtonLabel\" />\n    <Tooltip resid=\"eventButtonTooltip\" />\n    <Supertip>\n        <Title resid=\"eventSuperTipTitle\" />\n        <Description resid=\"eventSuperTipDescription\" />\n    </Supertip>\n    <Icon>\n        <bt:Image size=\"16\" resid=\"blue-icon-16\" />\n        <bt:Image size=\"32\" resid=\"blue-icon-32\" />\n        <bt:Image size=\"80\" resid=\"blue-icon-80\" />\n    </Icon>\n    <Action xsi:type=\"ExecuteFunction\">\n        <FunctionName>testEventObject</FunctionName>\n    </Action>\n</Control>\n// The button has an id attribute set to eventTestButton, and will invoke\n// the testEventObject function defined in the add-in.\n// That function looks like this:\nfunction testEventObject(event) {\n    // The event object implements the Event interface\n\n    // This value will be \"eventTestButton\"\n    var buttonId = event.source.id;\n\n    // Signal to the host app that processing is complete.\n    event.completed();\n}\n```\n```javascript\n// Function is used by two buttons:\n// button1 and button2\nfunction multiButton (event) {\n    // Check which button was clicked\n    var buttonId = event.source.id;\n\n    if (buttonId === 'button1') {\n        doButton1Action();\n    }\n    else {\n        doButton2Action();\n    }\n\n    event.completed();\n}\n```"
