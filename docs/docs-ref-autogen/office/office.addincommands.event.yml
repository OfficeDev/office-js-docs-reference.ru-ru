### YamlMime:UniversalReference
ms.openlocfilehash: 99b68a9c8525e05e27e381e43f1b31aa961d02a3
ms.sourcegitcommit: a422a2c3b9ada79477a9f873276b3c00765f7072
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2019
ms.locfileid: "30900407"
items:
- uid: office.Office.AddinCommands.Event
  summary: Объект Event передается в качестве параметра функциям надстроек, вызываемым кнопками команд без ПОЛЬЗОВАТЕЛЬСКОГО интерфейса. Этот объект позволяет надстройке определить нажатую кнопку и уведомить узел о завершении обработки.
  remarks: <table> <tr><td>Тип надстройки</td><td>Надстройки области задач, надстройки Outlook, контентные надстройки</td></tr> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>С ограничениями</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>
  name: Office.AddinCommands.Event
  fullName: Office.AddinCommands.Event
  langs:
  - typeScript
  type: interface
  package: office
  children:
  - office.Office.AddinCommands.Event.completed
  - office.Office.AddinCommands.Event.source
- uid: office.Office.AddinCommands.Event.completed
  summary: >-
    Указывает на то, что надстройка завершила обработку, активированную с помощью кнопки надстройки или обработчика события.


    Этот метод должен вызываться в конце функции, которая была вызвана командой надстройки, определенной с помощью элемента Action, для атрибута xsi: Type задано значение ExecuteFunction. При вызове этого метода клиент узла узнает, что функция завершена и что он может очистить любое состояние, связанное с вызовом функции. Например, если пользователь закроет Outlook до вызова этого метода, Outlook предупредит его, что функция по-прежнему выполняется.


    Этот метод необходимо вызывать в обработчике событий, добавленном с помощью метода Office.context.mailbox.addHandlerAsync, по завершении обработки события.


    \[[Набор API: Mailbox 1,3](/office/dev/add-ins/reference/javascript-api-for-office)\]
  remarks: >-
    <table> <tr><td>[Минимальный уровень разрешений](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td>С ограничениями</td></tr> <tr><td>[Применимый режим Outlook](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td>Создание или чтение</td></tr> </table>


    **Support details**


    Заглавная буква Y в следующей матрице указывает на то, что этот метод поддерживается в соответствующем ведущем приложении Office. Пустая ячейка означает, что ведущее приложение Office не поддерживает этот метод.


    Дополнительные сведения о требованиях к ведущему приложению и серверу Office приведены в статье требования к запуску надстроек [Office](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.


    *Поддерживаемые ведущие приложения на разных платформах* <table> <tr><th> </th><th> Office для компьютера с Windows </th><th> Office Online (в браузере) </th><th> Office для iPad </th></tr> <tr><td><strong>Невозможно</strong></td><td> Да </td><td> Да </td><td> Да </td></tr> <tr><td><strong>Приложению</strong></td><td> Y (с момента поЧтовых `options` ящиков 1,3: без параметра;<br>Предварительный просмотр почтового ящика: добавляет поддержку `options` параметра)</td><td> </td><td> </td></tr> <tr><td><strong>PowerPoint</strong></td><td> Да </td><td> Да </td><td> Да </td></tr> <tr><td><strong>Текстовых</strong></td><td> Да </td><td> Да </td><td> Да </td></tr> </table>

    #### <a name="examples"></a>Примеры


    ```javascript

    function processItem (event) {
        // Do some processing

        event.completed();
    }


    // In the following example, the checkMessage function has

    // been registered as an event handler for ItemSend.

    function checkMessage(event) {
        // Get the item being sent
        var outgoingMsg = Office.context.mailbox.item;

        // Check if subject contains "BLOCK"
        outgoingMsg.subject.getAsync(function (result) {
            // Subject is in result.value
            if (result.value.indexOf('BLOCK') != -1) {
                // Value is found, stop send
                event.completed({allowEvent = false});
            } else {
                // Value wasn't found, allow send
                event.completed({allowEvent = true});
            }
        });
    }

    ```
  name: completed(options)
  fullName: completed(options)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'completed(options?: { allowEvent: boolean }): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: options
      description: 'Необязательный. Объектный литерал, содержащий одно или несколько из указанных ниже свойств. Алловевент: логическое значение. Когда метод completed используется для сигнализации о завершении обработчика событий, это значение указывает на то, что обрабатываемое событие должно продолжить выполнение или оно будет отменено. Например, надстройка, обрабатывающая событие ItemSend, может задать Алловевент = false, чтобы отменить отправку сообщения.'
      type:
      - '{ allowEvent: boolean }'
- uid: office.Office.AddinCommands.Event.source
  summary: >-
    Сведения об элементе управления, который инициировал вызов этой функции.


    **Сведения о поддержке**


    Заглавная буква Y в следующей матрице указывает на то, что это свойство поддерживается в соответствующем ведущем приложении Office. Пустая ячейка означает, что ведущее приложение Office не поддерживает это свойство.


    Дополнительные сведения о требованиях к ведущему приложению и серверу Office приведены в статье требования к запуску надстроек [Office](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.


    *Поддерживаемые ведущие приложения на разных платформах* <table> <tr><th> </th><th> Office для компьютера с Windows </th><th> Office Online (в браузере) </th><th> Office для iPad </th></tr> <tr><td><strong>Приложению</strong></td><td> Y (почтовый ящик 1,3) </td><td> </td><td> </td></tr> </table>
  name: source
  fullName: source
  langs:
  - typeScript
  type: property
  syntax:
    content: source:Source;
    return:
      type:
      - office.Office.AddinCommands.Source
      description: "\n#### <a name=\"examples\"></a>Примеры\n\n```javascript\n// In this example, consider a button defined in an add-in manifest as follows:\n//<Control xsi:type=\"Button\" id=\"eventTestButton\">\n//    <Label resid=\"eventButtonLabel\" />\n//    <Tooltip resid=\"eventButtonTooltip\" />\n//    <Supertip>\n//        <Title resid=\"eventSuperTipTitle\" />\n//        <Description resid=\"eventSuperTipDescription\" />\n//    </Supertip>\n//    <Icon>\n//        <bt:Image size=\"16\" resid=\"blue-icon-16\" />\n//        <bt:Image size=\"32\" resid=\"blue-icon-32\" />\n//        <bt:Image size=\"80\" resid=\"blue-icon-80\" />\n//    </Icon>\n//    <Action xsi:type=\"ExecuteFunction\">\n//        <FunctionName>testEventObject</FunctionName>\n//    </Action>\n//</Control>\n\n// The button has an id attribute set to eventTestButton, and will invoke\n// the testEventObject function defined in the add-in.\n// That function looks like this:\nfunction testEventObject(event) {\n    // The event object implements the Event interface.\n\n    // This value will be \"eventTestButton\".\n    var buttonId = event.source.id;\n\n    // Signal to the host app that processing is complete.\n    event.completed();\n}\n```\n```javascript\n// Function is used by two buttons:\n// button1 and button2\nfunction multiButton (event) {\n    // Check which button was clicked.\n    var buttonId = event.source.id;\n\n    if (buttonId === 'button1') {\n        doButton1Action();\n    } else {\n        doButton2Action();\n    }\n\n    event.completed();\n}\n```"
