### YamlMime:UniversalReference
ms.openlocfilehash: ba8bb19feca95da10060b7bf35ac6063913360e9
ms.sourcegitcommit: b0b614f5315ab2e5c1e0ea51c687498f87684a07
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/15/2019
ms.locfileid: "30054963"
items:
- uid: office.Office.Settings
  summary: Представляет пользовательские параметры для надстройки области задач или контентной надстройки, которые хранятся в документе ведущего приложения как пары "имя-значение".
  remarks: >-
    <table> <tr><td>Узлы</td><td>Access, Excel, PowerPoint, Word</td></tr> <tr><td>Наборы требований</td><td>Параметры</td></tr> </table>


    Параметры, созданные с помощью методов объекта Settings, сохраняются для каждой надстройки и документа. То есть они доступны только для создавшей их надстройки и только из документа, в котором они сохранены.


    Имя параметра — это строка, а значение может быть String, Number, Boolean, null, Object или Array.


    Объект Settings автоматически загружается как часть объекта Document и доступен с помощью вызова свойства Settings этого объекта при активации надстройки.


    Разработчик отвечает за вызов метода saveAsync после добавления или удаления параметров для сохранения параметров в документе.
  name: Office.Settings
  fullName: Office.Settings
  langs:
  - typeScript
  type: interface
  package: office
  children:
  - office.Office.Settings.addHandlerAsync
  - office.Office.Settings.addHandlerAsync_1
  - office.Office.Settings.get
  - office.Office.Settings.refreshAsync
  - office.Office.Settings.remove
  - office.Office.Settings.removeHandlerAsync
  - office.Office.Settings.removeHandlerAsync_1
  - office.Office.Settings.saveAsync
  - office.Office.Settings.saveAsync_1
  - office.Office.Settings.set
- uid: office.Office.Settings.addHandlerAsync
  summary: >-
    Добавляет обработчик событий для события settingsChanged.


    **Важно!** код надстройки может зарегистрировать обработчик для события settingsChanged при запуске надстройки в любом клиенте Excel, но событие будет срабатывать только при загрузке надстройки с помощью электронной таблицы, открытой в Excel Online, и нескольких пользователей. редактирует электронную таблицу (совместное редактирование). Таким образом, событие settingsChanged поддерживается только в Excel Online в сценариях совместного редактирования.
  remarks: >-
    <table><tr><td>Наборы требований</td><td>Параметры</td></tr></table>


    Можно добавить несколько обработчиков событий для указанного объекта eventType, если имя каждой функции обработчика событий уникально.
  name: addHandlerAsync(eventType, handler, options, callback)
  fullName: addHandlerAsync(eventType, handler, options, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'addHandlerAsync(eventType: Office.EventType, handler: any, options?: Office.AsyncContextOptions, callback?: (result: AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: eventType
      description: Указывает тип добавляемого события. Обязательный.
      type:
      - Office.EventType
    - id: handler
      description: Добавляемая функция обработчика событий, единственный параметр которой имеет тип [Office. SettingsChangedEventArgs](xref:office.Office.SettingsChangedEventArgs)<!-- -->. Обязательно указывать.
      type:
      - any
    - id: options
      description: Предоставляет параметр для сохранения данных контекста любого типа без изменений для использования при обратном вызове.
      type:
      - office.Office.AsyncContextOptions
    - id: callback
      description: >-
        Необязательное свойство. Функция, вызываемая при возвращении обратного вызова, единственный параметр которой имеет тип [Office. AsyncResult](xref:office.Office.AsyncResult)<!-- -->.


        <table> <tr> <th>Свойство</th> <th>Применение</th> </tr> <tr> <td>AsyncResult.value</td> <td>Всегда возвращает значение undefine, так как данные или объекты, которые можно получить при добавлении обработчика событий, отсутствуют.</td> </tr> <tr> <td>AsyncResult.status</td> <td>Определяет, удалось ли выполнить операцию.</td> </tr> <tr> <td>AsyncResult.error</td> <td>Получает доступ к объекту Error, который содержит сведения об ошибке, если операция завершилась неудачно.</td> </tr> <tr> <td>AsyncResult.asyncContext</td> <td>Определяемый пользователем элемент любого типа, который возвращается в объекте AsyncResult без изменения.</td> </tr> </table>


        **Сведения о поддержке**


        Заглавная буква Y в следующей матрице указывает на то, что этот метод поддерживается в соответствующем ведущем приложении Office. Пустая ячейка означает, что ведущее приложение Office не поддерживает этот метод.


        Дополнительные сведения о требованиях к ведущему приложению и серверу Office приведены в разделе Требования к запуску надстроек [Office](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.


        *Поддерживаемые ведущие приложения на разных платформах* <table> <tr><th> </th><th> Office для компьютера с Windows </th><th> Office Online (в браузере) </th><th> Office для iPad </th></tr> <tr><td><strong>Обращения</strong></td><td> </td><td> Да </td><td> </td></tr> <tr><td><strong>Невозможно</strong></td><td> </td><td> Да </td><td> </td></tr> </table>
      type:
      - '(result: AsyncResult<void>) => void'
- uid: office.Office.Settings.addHandlerAsync_1
  summary: >-
    Добавляет обработчик событий для события settingsChanged.


    **Важно!** код надстройки может зарегистрировать обработчик для события settingsChanged при запуске надстройки в любом клиенте Excel, но событие будет срабатывать только при загрузке надстройки с помощью электронной таблицы, открытой в Excel Online, и нескольких пользователей. редактирует электронную таблицу (совместное редактирование). Таким образом, событие settingsChanged поддерживается только в Excel Online в сценариях совместного редактирования.
  remarks: "<table><tr><td>Наборы требований</td><td>Параметры</td></tr></table>\n\nМожно добавить несколько обработчиков событий для указанного объекта eventType, если имя каждой функции обработчика событий уникально.\n#### <a name=\"examples\"></a>Примеры\n\n```javascript\nfunction addSelectionChangedEventHandler() {\n    Office.context.document.settings.addHandlerAsync(Office.EventType.SettingsChanged, MyHandler);\n}\n\nfunction MyHandler(eventArgs) {\n    write('Event raised: ' + eventArgs.type);\n    doSomethingWithSettings(eventArgs.settings);\n}\n\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n```"
  name: addHandlerAsync(eventType, handler, callback)
  fullName: addHandlerAsync(eventType, handler, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'addHandlerAsync(eventType: Office.EventType, handler: any, callback?: (result: AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: eventType
      description: Указывает тип добавляемого события. Обязательный.
      type:
      - Office.EventType
    - id: handler
      description: Добавляемая функция обработчика событий, единственный параметр которой имеет тип [Office. SettingsChangedEventArgs](xref:office.Office.SettingsChangedEventArgs)<!-- -->. Обязательно указывать.
      type:
      - any
    - id: callback
      description: >-
        Необязательное свойство. Функция, вызываемая при возвращении обратного вызова, единственный параметр которой имеет тип [Office. AsyncResult](xref:office.Office.AsyncResult)<!-- -->.


        <table> <tr> <th>Свойство</th> <th>Применение</th> </tr> <tr> <td>AsyncResult.value</td> <td>Всегда возвращает значение undefine, так как данные или объекты, которые можно получить при добавлении обработчика событий, отсутствуют.</td> </tr> <tr> <td>AsyncResult.status</td> <td>Определяет, удалось ли выполнить операцию.</td> </tr> <tr> <td>AsyncResult.error</td> <td>Получает доступ к объекту Error, который содержит сведения об ошибке, если операция завершилась неудачно.</td> </tr> <tr> <td>AsyncResult.asyncContext</td> <td>Определяемый пользователем элемент любого типа, который возвращается в объекте AsyncResult без изменения.</td> </tr> </table>


        **Сведения о поддержке**


        Заглавная буква Y в следующей матрице указывает на то, что этот метод поддерживается в соответствующем ведущем приложении Office. Пустая ячейка означает, что ведущее приложение Office не поддерживает этот метод.


        Дополнительные сведения о требованиях к ведущему приложению и серверу Office приведены в разделе Требования к запуску надстроек [Office](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.


        *Поддерживаемые ведущие приложения на разных платформах* <table> <tr><th> </th><th> Office для компьютера с Windows </th><th> Office Online (в браузере) </th><th> Office для iPad </th></tr> <tr><td><strong>Обращения</strong></td><td> </td><td> Да </td><td> </td></tr> <tr><td><strong>Невозможно</strong></td><td> </td><td> Да </td><td> </td></tr> </table>
      type:
      - '(result: AsyncResult<void>) => void'
- uid: office.Office.Settings.get
  summary: Извлекает указанный параметр.
  remarks: "<table><tr><td>Наборы требований</td><td>Параметры</td></tr></table>\n\n**Сведения о поддержке**\n\nЗаглавная буква Y в следующей матрице указывает на то, что этот метод поддерживается в соответствующем ведущем приложении Office. Пустая ячейка означает, что ведущее приложение Office не поддерживает этот метод.\n\nДополнительные сведения о требованиях к ведущему приложению и серверу Office приведены в разделе Требования к запуску надстроек [Office](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.\n\n*Поддерживаемые ведущие приложения на разных платформах* <table> <tr><th> </th><th> Office для компьютера с Windows </th><th> Office Online (в браузере) </th><th> Office for iPad </th><th> Office for Mac </th></tr> <tr><td><strong>Обращения</strong></td><td> </td><td> Да </td><td> </td><td> </td></tr> <tr><td><strong>Невозможно</strong></td><td> Да </td><td> Да </td><td> Да </td><td> Да </td></tr> <tr><td><strong>PowerPoint</strong></td><td> Да </td><td> Да </td><td> Да </td><td> Да </td></tr> <tr><td><strong>Текстовых</strong></td><td> Да </td><td> Да </td><td> Да </td><td> Да </td></tr> </table>\n#### <a name=\"examples\"></a>Примеры\n\n```javascript\nfunction displayMySetting() {\n    write('Current value for mySetting: ' + Office.context.document.settings.get('mySetting'));\n}\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n```"
  name: get(name)
  fullName: get(name)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'get(name: string): any;'
    return:
      type:
      - any
      description: Объект, содержащий имена свойств, сопоставленные с сериализованными значениями JSON.
    parameters:
    - id: name
      description: ''
      type:
      - string
- uid: office.Office.Settings.refreshAsync
  summary: Считывает все параметры, сохраненные в документе, и обновляет копию этих параметров в памяти для контентной надстройки или надстройки области задач.
  remarks: "<table><tr><td>Наборы требований</td><td>Параметры</td></tr></table>\n\nЭтот метод полезен в сценариях совместного редактирования Excel, Word и PowerPoint, когда несколько экземпляров одной и той же надстройки работают с одним и тем же документом. Так как каждая надстройка работает с копией параметров, загруженных из памяти документа, на момент открытия его пользователем, значения параметров, используемых каждым пользователем, могут быть получены из синхронизации. Это может произойти, когда экземпляр надстройки вызывает метод Settings. saveAsync для сохранения всех параметров этого пользователя в документе. Вызов метода refreshAsync из обработчика событий для события settingsChanged надстройки приведет к обновлению значений параметров для всех пользователей.\n\nВ функции обратного вызова, переданной в метод refreshAsync, можно использовать свойства объекта AsyncResult, чтобы получить следующие сведения.\n\n<table> <tr> <th>Свойство</th> <th>Применение</th> </tr> <tr> <td>AsyncResult.value</td> <td>Получает доступ к объекту Settings с обновленными значениями.</td> </tr> <tr> <td>AsyncResult.status</td> <td>Определяет, удалось ли выполнить операцию.</td> </tr> <tr> <td>AsyncResult.error</td> <td>Получает доступ к объекту Error, который содержит сведения об ошибке, если операция завершилась неудачно.</td> </tr> <tr> <td>AsyncResult.asyncContext</td> <td>Определяемый пользователем элемент любого типа, который возвращается в объекте AsyncResult без изменения.</td> </tr> </table>\n\n**Сведения о поддержке**\n\nЗаглавная буква Y в следующей матрице указывает на то, что этот метод поддерживается в соответствующем ведущем приложении Office. Пустая ячейка означает, что ведущее приложение Office не поддерживает этот метод.\n\nДополнительные сведения о требованиях к ведущему приложению и серверу Office приведены в разделе Требования к запуску надстроек [Office](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.\n\n*Поддерживаемые ведущие приложения на разных платформах* <table> <tr><th> </th><th> Office для компьютера с Windows </th><th> Office Online (в браузере) </th><th> Office для iPad </th></tr> <tr><td><strong>Обращения</strong></td><td> </td><td> Да </td><td> </td></tr> <tr><td><strong>Невозможно</strong></td><td> Да </td><td> Да </td><td> </td></tr> <tr><td><strong>PowerPoint</strong></td><td> Да </td><td> Да </td><td> </td></tr> <tr><td><strong>Текстовых</strong></td><td> Да </td><td> Да </td><td> </td></tr> </table>\n#### <a name=\"examples\"></a>Примеры\n\n```javascript\nfunction refreshSettings() {\n    Office.context.document.settings.refreshAsync(function (asyncResult) {\n        write('Settings refreshed with status: ' + asyncResult.status);\n    });\n}\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n```"
  name: refreshAsync(callback)
  fullName: refreshAsync(callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'refreshAsync(callback?: (result: AsyncResult<Office.Settings>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: callback
      description: Необязательное свойство. Функция, вызываемая при возвращении обратного вызова, единственный параметр которой имеет тип [Office. AsyncResult](xref:office.Office.AsyncResult)<!-- -->. Значением `value` свойства является объект [Office. Settings](xref:office.Office.Settings) с обновленными значениями.
      type:
      - '(result: AsyncResult<Office.Settings>) => void'
- uid: office.Office.Settings.remove
  summary: >-
    Удаляет указанный параметр.


    **Важно!** Обратите внимание на то, что метод Settings. Remove влияет только на копию контейнера свойств параметров параметров, нашедшегося в памяти. Чтобы не допустить удаления указанного параметра в документе, в некоторый момент после вызова метода Settings. Remove и перед закрытием надстройки необходимо вызвать метод Settings. saveAsync.
  remarks: >-
    <table><tr><td>Наборы требований</td><td>Параметры</td></tr></table>


    NULL является допустимым значением параметра, поэтому присвоение значения NULL не удалит параметр из контейнера свойств параметров.


    **Сведения о поддержке**


    Заглавная буква Y в следующей матрице указывает на то, что этот метод поддерживается в соответствующем ведущем приложении Office. Пустая ячейка означает, что ведущее приложение Office не поддерживает этот метод.


    Дополнительные сведения о требованиях к ведущему приложению и серверу Office приведены в разделе Требования к запуску надстроек [Office](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.


    *Поддерживаемые ведущие приложения на разных платформах* <table> <tr><th> </th><th> Office для компьютера с Windows </th><th> Office Online (в браузере) </th><th> Office for iPad </th><th> Office for Mac </th></tr> <tr><td><strong>Обращения</strong></td><td> </td><td> Да </td><td> </td><td> </td></tr> <tr><td><strong>Невозможно</strong></td><td> Да </td><td> Да </td><td> Да </td><td> Да </td></tr> <tr><td><strong>PowerPoint</strong></td><td> Да </td><td> Да </td><td> Да </td><td> Да </td></tr> <tr><td><strong>Текстовых</strong></td><td> Да </td><td> Да </td><td> Да </td><td> Да </td></tr> </table>

    #### <a name="examples"></a>Примеры


    ```javascript

    function removeMySetting() {
        Office.context.document.settings.remove('mySetting');
    }

    ```
  name: remove(name)
  fullName: remove(name)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'remove(name: string): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: name
      description: ''
      type:
      - string
- uid: office.Office.Settings.removeHandlerAsync
  summary: Удаляет обработчик события settingsChanged.
  remarks: >-
    <table><tr><td>Наборы требований</td><td>Параметры</td></tr></table>


    Если необязательный параметр Handler опущен при вызове метода removeHandlerAsync, все обработчики событий для указанного объекта eventType будут удалены.


    При выполнении функции, переданной в параметр callback, она получает объект AsyncResult, к которому можно получить доступ с помощью единственного параметра функции обратного вызова.


    В функции обратного вызова, переданной в метод removeHandlerAsync, можно использовать свойства объекта AsyncResult, чтобы получить следующие сведения.


    **Сведения о поддержке**


    Заглавная буква Y в следующей матрице указывает на то, что этот метод поддерживается в соответствующем ведущем приложении Office. Пустая ячейка означает, что ведущее приложение Office не поддерживает этот метод.


    Дополнительные сведения о требованиях к ведущему приложению и серверу Office приведены в разделе Требования к запуску надстроек [Office](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.


    *Поддерживаемые ведущие приложения на разных платформах* <table> <tr><th> </th><th> Office для компьютера с Windows </th><th> Office Online (в браузере) </th><th> Office для iPad </th></tr> <tr><td><strong>Обращения</strong></td><td> </td><td> Да </td><td> </td></tr> <tr><td><strong>Невозможно</strong></td><td> </td><td> Да </td><td> </td></tr> </table>
  name: removeHandlerAsync(eventType, options, callback)
  fullName: removeHandlerAsync(eventType, options, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'removeHandlerAsync(eventType: Office.EventType, options?: RemoveHandlerOptions, callback?: (result: AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: eventType
      description: Указывает тип удаляемого события. Обязательный параметр.
      type:
      - Office.EventType
    - id: options
      description: Предоставляет параметры для определения обработчика событий или обработчиков, которые удаляются.
      type:
      - office.Office.RemoveHandlerOptions
    - id: callback
      description: Необязательное свойство. Функция, вызываемая при возвращении обратного вызова, единственный параметр которой имеет тип [Office. AsyncResult](xref:office.Office.AsyncResult)<!-- -->.
      type:
      - '(result: AsyncResult<void>) => void'
- uid: office.Office.Settings.removeHandlerAsync_1
  summary: Удаляет обработчик события settingsChanged.
  remarks: "<table><tr><td>Наборы требований</td><td>Параметры</td></tr></table>\n\nЕсли необязательный параметр Handler опущен при вызове метода removeHandlerAsync, все обработчики событий для указанного объекта eventType будут удалены.\n\nПри выполнении функции, переданной в параметр callback, она получает объект AsyncResult, к которому можно получить доступ с помощью единственного параметра функции обратного вызова.\n\nВ функции обратного вызова, переданной в метод removeHandlerAsync, можно использовать свойства объекта AsyncResult, чтобы получить следующие сведения.\n\n**Сведения о поддержке**\n\nЗаглавная буква Y в следующей матрице указывает на то, что этот метод поддерживается в соответствующем ведущем приложении Office. Пустая ячейка означает, что ведущее приложение Office не поддерживает этот метод.\n\nДополнительные сведения о требованиях к ведущему приложению и серверу Office приведены в разделе Требования к запуску надстроек [Office](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.\n\n*Поддерживаемые ведущие приложения на разных платформах* <table> <tr><th> </th><th> Office для компьютера с Windows </th><th> Office Online (в браузере) </th><th> Office для iPad </th></tr> <tr><td><strong>Обращения</strong></td><td> </td><td> Да </td><td> </td></tr> <tr><td><strong>Невозможно</strong></td><td> </td><td> Да </td><td> </td></tr> </table>\n#### <a name=\"examples\"></a>Примеры\n\n```javascript\nfunction removeSettingsChangedEventHandler() {\n    Office.context.document.settings.removeHandlerAsync(Office.EventType.SettingsChanged, MyHandler);\n}\n\nfunction MyHandler(eventArgs) {\n    write('Event raised: ' + eventArgs.type);\n    doSomethingWithSettings(eventArgs.settings);\n}\n\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n```"
  name: removeHandlerAsync(eventType, callback)
  fullName: removeHandlerAsync(eventType, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'removeHandlerAsync(eventType: Office.EventType, callback?: (result: AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: eventType
      description: Указывает тип удаляемого события. Обязательный параметр.
      type:
      - Office.EventType
    - id: callback
      description: Необязательное свойство. Функция, вызываемая при возвращении обратного вызова, единственный параметр которой имеет тип [Office. AsyncResult](xref:office.Office.AsyncResult)<!-- -->.
      type:
      - '(result: AsyncResult<void>) => void'
- uid: office.Office.Settings.saveAsync
  summary: Хранится в копии контейнера свойств параметров в документе, содержащейся в памяти.
  remarks: >-
    Все параметры, ранее сохраненные надстройкой, загружаются при ее инициализации, поэтому на протяжении всего сеанса можно использовать только методы set и get для работы с копией контейнера свойств в памяти. Если требуется сохранить параметры, чтобы они были доступны при следующем использовании надстройки, воспользуйтесь методом saveAsync.


    **Note**: метод saveAsync сохраняет в файле документа контейнер свойств параметров в памяти. Однако изменения в самом файле документа сохраняются только в том случае, если пользователь (или параметр автосохранения) сохраняет документ в файловой системе. Метод refreshAsync полезен только в сценариях совместного редактирования, если другие экземпляры одной и той же надстройки могут изменить параметры, и эти изменения должны быть сделаны доступными для всех экземпляров.


    <table> <tr> <th>Свойство</th> <th>Применение</th> </tr> <tr> <td>AsyncResult.value</td> <td>Всегда возвращает значение undefine, так как нет объекта или данных для извлечения.</td> </tr> <tr> <td>AsyncResult.status</td> <td>Определяет, удалось ли выполнить операцию.</td> </tr> <tr> <td>AsyncResult.error</td> <td>Получает доступ к объекту Error, который содержит сведения об ошибке, если операция завершилась неудачно.</td> </tr> <tr> <td>AsyncResult.asyncContext</td> <td>Определяемый пользователем элемент любого типа, который возвращается в объекте AsyncResult без изменения.</td> </tr> </table>


    **Сведения о поддержке**


    Заглавная буква Y в следующей матрице указывает на то, что этот метод поддерживается в соответствующем ведущем приложении Office. Пустая ячейка означает, что ведущее приложение Office не поддерживает этот метод.


    Дополнительные сведения о требованиях к ведущему приложению и серверу Office приведены в разделе Требования к запуску надстроек [Office](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.


    *Поддерживаемые ведущие приложения на разных платформах* <table> <tr><th> </th><th> Office для компьютера с Windows </th><th> Office Online (в браузере) </th><th> Office for iPad </th><th> Office for Mac </th></tr> <tr><td><strong>Обращения</strong></td><td> </td><td> Да </td><td> </td><td> </td></tr> <tr><td><strong>Невозможно</strong></td><td> Да </td><td> Да </td><td> Да </td><td> Да </td></tr> <tr><td><strong>PowerPoint</strong></td><td> Да </td><td> Да </td><td> Да </td><td> Да </td></tr> <tr><td><strong>Текстовых</strong></td><td> Да </td><td> Да </td><td> Да </td><td> Да </td></tr> </table>
  name: saveAsync(options, callback)
  fullName: saveAsync(options, callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'saveAsync(options?: SaveSettingsOptions, callback?: (result: AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: options
      description: Предоставляет параметры для сохранения параметров.
      type:
      - office.Office.SaveSettingsOptions
    - id: callback
      description: Необязательное свойство. Функция, вызываемая при возвращении обратного вызова, единственный параметр которой имеет тип [Office. AsyncResult](xref:office.Office.AsyncResult)<!-- -->.
      type:
      - '(result: AsyncResult<void>) => void'
- uid: office.Office.Settings.saveAsync_1
  summary: Хранится в копии контейнера свойств параметров в документе, содержащейся в памяти.
  remarks: "Все параметры, ранее сохраненные надстройкой, загружаются при ее инициализации, поэтому на протяжении всего сеанса можно использовать только методы set и get для работы с копией контейнера свойств в памяти. Если требуется сохранить параметры, чтобы они были доступны при следующем использовании надстройки, воспользуйтесь методом saveAsync.\n\n**Note**: метод saveAsync сохраняет в файле документа контейнер свойств параметров в памяти. Однако изменения в самом файле документа сохраняются только в том случае, если пользователь (или параметр автосохранения) сохраняет документ в файловой системе. Метод refreshAsync полезен только в сценариях совместного редактирования, если другие экземпляры одной и той же надстройки могут изменить параметры, и эти изменения должны быть сделаны доступными для всех экземпляров.\n\n<table> <tr> <th>Свойство</th> <th>Применение</th> </tr> <tr> <td>AsyncResult.value</td> <td>Всегда возвращает значение undefine, так как нет объекта или данных для извлечения.</td> </tr> <tr> <td>AsyncResult.status</td> <td>Определяет, удалось ли выполнить операцию.</td> </tr> <tr> <td>AsyncResult.error</td> <td>Получает доступ к объекту Error, который содержит сведения об ошибке, если операция завершилась неудачно.</td> </tr> <tr> <td>AsyncResult.asyncContext</td> <td>Определяемый пользователем элемент любого типа, который возвращается в объекте AsyncResult без изменения.</td> </tr> </table>\n\n**Сведения о поддержке**\n\nЗаглавная буква Y в следующей матрице указывает на то, что этот метод поддерживается в соответствующем ведущем приложении Office. Пустая ячейка означает, что ведущее приложение Office не поддерживает этот метод.\n\nДополнительные сведения о требованиях к ведущему приложению и серверу Office приведены в разделе Требования к запуску надстроек [Office](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.\n\n*Поддерживаемые ведущие приложения на разных платформах* <table> <tr><th> </th><th> Office для компьютера с Windows </th><th> Office Online (в браузере) </th><th> Office for iPad </th><th> Office for Mac </th></tr> <tr><td><strong>Обращения</strong></td><td> </td><td> Да </td><td> </td><td> </td></tr> <tr><td><strong>Невозможно</strong></td><td> Да </td><td> Да </td><td> Да </td><td> Да </td></tr> <tr><td><strong>PowerPoint</strong></td><td> Да </td><td> Да </td><td> Да </td><td> Да </td></tr> <tr><td><strong>Текстовых</strong></td><td> Да </td><td> Да </td><td> Да </td><td> Да </td></tr> </table>\n#### <a name=\"examples\"></a>Примеры\n\n```javascript\nfunction persistSettings() {\n    Office.context.document.settings.saveAsync(function (asyncResult) {\n        write('Settings saved with status: ' + asyncResult.status);\n    });\n}\n// Function that writes to a div with id='message' on the page.\nfunction write(message){\n    document.getElementById('message').innerText += message; \n}\n```"
  name: saveAsync(callback)
  fullName: saveAsync(callback)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'saveAsync(callback?: (result: AsyncResult<void>) => void): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: callback
      description: Необязательное свойство. Функция, вызываемая при возвращении обратного вызова, единственный параметр которой имеет тип [Office. AsyncResult](xref:office.Office.AsyncResult)<!-- -->.
      type:
      - '(result: AsyncResult<void>) => void'
- uid: office.Office.Settings.set
  summary: >-
    Устанавливает или создает указанный параметр.


    **Важно!** Обратите внимание на то, что метод Settings. Set влияет только на копию контейнера свойств параметров параметров, нашедшегося в памяти. Чтобы надстройка была доступна надстройке при следующем открытии документа, в какой-то момент после вызова метода Settings. Set и перед закрытием надстройки необходимо вызвать метод Settings. saveAsync для сохранения. параметры в документе.
  remarks: >-
    <table><tr><td>Наборы требований</td><td>Параметры</td></tr></table>


    Метод Set создает новое значение указанного имени, если оно еще не существует, или задает существующее значение указанного имени в копии контейнера свойств параметров в памяти. После вызова метода Settings. saveAsync значение сохраняется в документе как сериализованное представление объекта типа данных в формате JSON. Для параметров каждой надстройки доступно не более 2 МБ.


    **Сведения о поддержке**


    Заглавная буква Y в следующей матрице указывает на то, что этот метод поддерживается в соответствующем ведущем приложении Office. Пустая ячейка означает, что ведущее приложение Office не поддерживает этот метод.


    Дополнительные сведения о требованиях к ведущему приложению и серверу Office приведены в разделе Требования к запуску надстроек [Office](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.


    *Поддерживаемые ведущие приложения на разных платформах* <table> <tr><th> </th><th> Office для компьютера с Windows </th><th> Office Online (в браузере) </th><th> Office for iPad </th><th> Office for Mac </th></tr> <tr><td><strong>Обращения</strong></td><td> </td><td> Да </td><td> </td><td> </td></tr> <tr><td><strong>Невозможно</strong></td><td> Да </td><td> Да </td><td> Да </td><td> Да </td></tr> <tr><td><strong>PowerPoint</strong></td><td> Да </td><td> Да </td><td> Да </td><td> Да </td></tr> <tr><td><strong>Текстовых</strong></td><td> Да </td><td> Да </td><td> Да </td><td> Да </td></tr> </table>

    #### <a name="examples"></a>Примеры


    ```javascript

    function setMySetting() {
        Office.context.document.settings.set('mySetting', 'mySetting value');
    }

    ```
  name: set(name, value)
  fullName: set(name, value)
  langs:
  - typeScript
  type: method
  syntax:
    content: 'set(name: string, value: any): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: name
      description: ''
      type:
      - string
    - id: value
      description: Задает значение для сохранения.
      type:
      - any
